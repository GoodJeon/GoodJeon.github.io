---
layout: posts
comments: true
title: "[íŒŒì´ì¬ í†µê³„ë¶„ì„]ì¶”ë¡  í†µê³„ ê°•ì˜ ìš”ì•½"
categories: Python
tag: [python, íŒŒì´ì¬, í†µê³„, statistics]
toc: true
toc_sticky: true
date: 2022-01-18
last_modified_at: 2022-01-18


---

**[Noitce]** ê³ ì³ì•¼í•˜ê±°ë‚˜ í‹€ë¦° ê²ƒì´ ìˆìœ¼ë©´ ë§ì”€í•´ì£¼ì„¸ìš”!
{: .notice--info}



í .. ì†”ì§íˆ ì´ë²ˆ ì •ë¦¬ëŠ” ë„ˆë¬´ ë¹ ì§„ ë¶€ë¶„ì´ ë§ë‹¤. ì¶”ë¡  í†µê³„ ë¶€ë¶„ì€ ê°„ë‹¨í•˜ê³  ë¹ ë¥´ê²Œ ë„˜ì–´ê°€ì…”ì„œ ì´ ì •ë¦¬ë³´ë‹¤ëŠ” ì±…ì„  ë³´ëŠ”ê²Œ ë” ë‚˜ì„ ê²ƒ ê°™ì§€ë§Œ ê·¸ë˜ë„ ì˜¬ë ¤ë³´ê² ë‹¤.ğŸ‘´

<br>



# ì¶”ë¡  í†µê³„(Predictive Analysis)

* ì¼ë¶€ ë°ì´í„°ë¡œë¶€í„° ì „ì²´ì˜ í†µê³„ì  ì„±ì§ˆì„ ì¶”ì¸¡
* í‘œë³¸ ì •ë³´(í†µê³„ëŸ‰)ì— ì…ê°í•´ ëª¨ì§‘ë‹¨ì˜ ì •ë³´ë¥¼ ì–»ì–´ë‚´ëŠ” ê³¼ì •
  * ì¶”ì • : ì ì¶”ì •, êµ¬ê°„ì¶”ì •
  * ê²€ì • : ê°€ì„¤ê²€ì •

---

## í™•ë¥ (probability)

* ì–´ë–¤ ì‚¬ê±´ì´ ì¼ì–´ë‚  ê°€ëŠ¥ì„±
* ì˜ˆì‹œ) ë™ì „ ë˜ì§€ê¸°ì— ì•ë©´ì´ ë‚˜ì˜¬ ê°€ëŠ¥ì„±, ì£¼ì‚¬ìœ„ì—ì„œ 1ì´ ë‚˜ì˜¬ í™•ë¥ 

### 1) ê°ê´€ì  í™•ë¥ 

* ì‹¤í—˜ì´ë‚˜ ê´€ì°°ì˜ í•„ìš”ì— ë”°ë¼ êµ¬ë¶„

#### ë…¼ë¦¬ì  í™•ë¥ (ìˆ˜í•™ì  í™•ë¥ )

* **ì–´ë–¤ í•œ ì‹œí–‰ì—ì„œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ê²°ê³¼ì˜ ê°œìˆ˜**
* ë™ì „ë˜ì§€ê¸°, ì£¼ì‚¬ìœ„ë˜ì§€ê¸°

#### ê²½í—˜ì  í™•ë¥ (í†µê³„ì  í™•ë¥ )

* ë™ì¼í•œ ì¡°ê±´í•˜ì—ì„œ ê°™ì€ **ì‹¤í—˜ì„ ë°˜ë³µ**í–ˆì„ ë•Œ ì–´ë–¤ íŠ¹ì •í•œ ì‚¬ê±´ì´ ë°œìƒí•œ ë¹„ìœ¨, ìƒëŒ€ë„ìˆ˜ë¡œ ê³„ì‚°

### 2) ì£¼ê´€ì  í™•ë¥ 

### 3) ê³µë¦¬ì  í•´ì„

* ëª¨ë“  í™•ë¥ ì€ ë‹¤ìŒì˜ ê³µë¦¬ë¥¼ ë§Œì¡±
* A.N. Kolmogorov(1933)ì˜ í™•ë¥ ì˜ ê³µë¦¬

### 4) ì£¼ë³€í™•ë¥ ê³¼ ê²°í•©í™•ë¥ 

### 5) ì¡°ê±´ë¶€ í™•ë¥ (conditional probability)

* ì¼ë¶€ ì¡°ê±´ì´ ì£¼ì–´ì§„ ê²½ìš°ì— ì‚¬ê±´ì´ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê²½ìš°

### 6) ë…ë¦½ ì‚¬ìƒ

### 7) í•©ë¥ ì˜ í•©ë²•ì¹™ê³¼ ê³±ë²•ì¹™

### 8) ì „í™•ë¥ ì˜ ì •ë¦¬

### 9) ë² ì´ì¦ˆ ì •ë¦¬(Bayes' theorem)

## í™•ë¥ ë¶„í¬ì™€ í™•ë¥ ë³€ìˆ˜

### 1) í™•ë¥ ë¶„í¬(probability distribution)

* ë„ìˆ˜ë¶„í¬í‘œ ë° íˆìŠ¤í† ê·¸ë¨ì„ í™•ë¥ ë¶„í¬ë¼ í•œë‹¤.

### 2) í™•ë¥ ë³€ìˆ˜(random variable)

* ì‹¤í—˜ì´ë‚˜ ê´€ì°°ì˜ ê²°ê³¼ ê°’ì„ 1:1 ì‹¤ìˆ˜ë¡œ ëŒ€ì‘ì‹œí‚¤ëŠ” í•¨ìˆ˜
* ë™ì „ì„ ë˜ì§€ëŠ” ì‹¤í—˜ì—ì„œ ì•ë©´ì´ ë‚˜ì˜¨ íšŸìˆ˜ì— ëŒ€í•œ

### 3) í™•ë¥  ë³€ìˆ˜ì˜ êµ¬ë¶„

* ì´ì‚°í™•ë¥ ë³€ìˆ˜ : ë³€ìˆ˜ê°€ ì·¨í•  ìˆ˜ ìˆëŠ” ê°’ì˜ ê°œìˆ˜ê°€ **ìœ í•œ**(**íˆìŠ¤í† ê·¸ë¨**)
* ì—°ì†í™•ë¥ ë³€ìˆ˜ : ë³€ìˆ˜ê°€ ì·¨í•  ìˆ˜ ìˆëŠ” ê°’ì˜ ê°œìˆ˜ê°€ **ë¬´í•œ**(**ë§‰ëŒ€ê·¸ë˜í”„**)

### 4) í™•ë¥  í•¨ìˆ˜

### 5) í™•ë¥  ë¶„í¬ì˜ í‰ê· (mean)

* ê¸°ëŒ€ê°’(expected value)
* **E(X)** ë¡œ í‘œì‹œ
* ì´ì‚°í™•ë¥  ë¶„í¬ì˜ ê¸°ëŒ€ê°’ : í™•ë¥ ì„ ê°€ì¤‘ê°’ìœ¼ë¡œ ì‚¬ìš©í•œ ê°€ì¤‘í‰ê· 
* ì—°ì†í™•ë¥ ë¶„í¬ì˜ ê¸°ëŒ€ê°’ : ì ë¶„ê°œë…ì˜ ë©´ì 

### 6) í™•ë¥  ë¶„í¬ ì¢…ë¥˜

* ì´ì‚°í˜• í™•ë¥ ë¶„í¬
  * ì´í•­ë¶„í¬(binomial distribution)
  * í¬ì•„ì†¡ë¶„í¬(poisson distribution)
* ì—°ì†í˜• í™•ë¥ ë¶„í¬ 
  * t ë¶„í¬ : ì†Œí‘œë³¸ ëª¨ì§‘ë‹¨ í‰ê·  ì¶”ë¡  ì‹œ í™œìš©
  * í‘œì¤€ì •ê·œë¶„í¬ : ëŒ€í‘œë³¸ ëª¨ì§‘ë‹¨ì˜ í•©, í‰ê·  ì¶”ë¡  ì‹œ í™œìš©
  * ì¹´ì´ì œê³± ë¶„í¬ : ëª¨ì§‘ë‹¨ ë¶„ì‚° ì¶”ë¡  ì‹œ(ë°ì´í„° ì •ê·œë¶„í¬ ê°€ì •) í™œìš©
  * F ë¶„í¬ : ë‘ ëª¨ì§‘ë‹¨ ë¶„ì‚° ì°¨ì´ ë¹„êµ ì‹œ í™œìš©(ë°ì´í„° ì •ê·œë¶„í¬ ê°€ì •)

#### ì´í•­ ë¶„í¬

* ë² ë¥´ëˆ„ì´ ì‹œí–‰(Bernoulli trial)
  * ì‹œí–‰ ë˜ëŠ” ì‹¤í—˜ì˜ ê²°ê³¼ê°€ ë‘ê°€ì§€ ì¤‘ í•˜ë‚˜ì¸ ê²½ìš°

* ì´í•­ë¶„í¬
  * X = ì„±ê³µì˜ í™•ë¥ ì´ pì¸ ë² ë¥´ëˆ„ì´ ì‹œí–‰ì„ në²ˆ ë°˜ë³µí•  ëŒ€ ì„±ê³µì˜ ìˆ˜
  * ì„±ê³µí™•ë¥ ì´ 0.5ì— ê°€ê¹Œìš°ë©´ ì‹œí–‰íšŒìˆ˜ nì˜ í¬ê¸°ì— ê´€ê³„ ì—†ì´ ì¢Œìš°ëŒ€ì¹­ ì¢… ëª¨ì–‘ì„ í•¨

#### ì •ê·œë¶„í¬

* ê°€ì¥ ëŒ€í‘œì ì¸ ë¶„í¬
* ê°€ìš°ì§€ì•ˆ(Gaussian) ë¶„í¬
* ì—°ì†í˜• í™•ë¥ ë³€ìˆ˜ì— ëŒ€í•œ ë¶„í¬
* í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¡œ ëª¨ì–‘ì´ ê²°ì •
  * ì¢Œìš°ëŒ€ì¹­, ì¢…ëª¨ì–‘
  * ì¤‘ì•™ í•œì ì´ ë¾°ì¡±
* ìì—°ê³„, ì‚¬íšŒí˜„ìƒì— ë§ì´ ë‚˜íƒ€ë‚¨
* í‰ê·  ì£¼ìœ„ë¡œ **+-1í‘œì¤€í¸ì°¨, +-2í‘œì¤€í¸ì°¨, +-3í‘œì¤€í¸ì°¨ ì•ˆì— ì•½ 68%, 95%, 99%ì˜ ë°ì´í„°**ê°€ ìˆë‹¤.
* **í‰ê· ì„ 0, í‘œì¤€í¸ì°¨ë¥¼ 1ë¡œ ë³€í™˜í•˜ë©´ í‘œì¤€ì •ê·œë¶„í¬(Zë¶„í¬)**

---

<br>

## í‘œë³¸ì˜ ì¶”ì¶œë°©ë²•

* ë¬´ì‘ìœ„ (ì„ì˜)ì¶”ì¶œ : ì„ì˜ë¡œ í‘œë³¸ì„ ì¶”ì¶œí•˜ëŠ” ë°©ë²•
* ë³µì›ì¶”ì¶œ : ì—¬ëŸ¬ ì°¨ë¡€ ë™ì¼í•œ í‘œë³¸ì„ ì„ íƒí•˜ëŠ” ë°©ë²•
* ë¹„ë³µì›ì¶”ì¶œ : ë™ì¼í•œ í‘œë³¸ì€ í•œë²ˆë§Œ ì„ íƒí•˜ëŠ” ë°©ë²„


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

%precision 3
%matplotlib inline
```


```python
df = pd.read_csv('./data/ch4_scores400.csv')
scores = df['score']
scores[:10]
```




    0    76
    1    55
    2    80
    3    80
    4    74
    5    61
    6    81
    7    76
    8    23
    9    80
    Name: score, dtype: int64




```python
# ë³µì› ì¶”ì¶œ : ë™ì¼í•œ ìˆ«ìê°€ ì¶”ì¶œ ë  ìˆ˜ ìˆìŒ.
np.random.choice([1,2,3],3)
```




    array([3, 3, 1])




```python
# ë¹„ë³µì› ì¶”ì¶œ : ë™ì¼í•œ ìˆ«ìê°€ ì¶”ì¶œ X
np.random.choice([1,2,3],3, replace=False)
```




    array([2, 3, 1])




```python
np.random.seed(123)
np.random.choice([1,2,3],3)
```




    array([3, 2, 3])




```python
# scores ë°ì´í„°ì—ì„œ sample ì¶”ì¶œ
np.random.seed(0)
sample = np.random.choice(scores, 20)

# í‘œë³¸ í‰ê· 
sample.mean()
```




    70.4




```python
# ì „ì²´ ë°ì´í„°ì˜ í‰ê· 
scores.mean()
```




    69.530




```python
for i in range(5):
    sample = np.random.choice(scores, 20)
    print(f'{i+1}ë²ˆì§¸ ë¬´ì‘ìœ„ ì¶”ì¶œë¡œ ì–»ì€ í‘œë³¸í‰ê·  {sample.mean()}')
```

    1ë²ˆì§¸ ë¬´ì‘ìœ„ ì¶”ì¶œë¡œ ì–»ì€ í‘œë³¸í‰ê·  72.45
    2ë²ˆì§¸ ë¬´ì‘ìœ„ ì¶”ì¶œë¡œ ì–»ì€ í‘œë³¸í‰ê·  63.7
    3ë²ˆì§¸ ë¬´ì‘ìœ„ ì¶”ì¶œë¡œ ì–»ì€ í‘œë³¸í‰ê·  66.05
    4ë²ˆì§¸ ë¬´ì‘ìœ„ ì¶”ì¶œë¡œ ì–»ì€ í‘œë³¸í‰ê·  71.7
    5ë²ˆì§¸ ë¬´ì‘ìœ„ ì¶”ì¶œë¡œ ì–»ì€ í‘œë³¸í‰ê·  74.15


## í™•ë¥  ëª¨ë¸


```python
# ë¶ˆê³µì •í•œ ì£¼ì‚¬ìœ„ì˜ í™•ë¥ ë¶„í¬ë¥¼ êµ¬í•˜ëŠ” ì‹¤í—˜
# í™•ë¥  ë³€ìˆ˜ì— í•„ìš”í•œ ë³€ìˆ˜ê°€ ì·¨í•  ìˆ˜ ìˆëŠ” ê°’ : dice
dice = [1,2,3,4,5,6]

# ê·¸ ê°’ì´ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ” í™•ë¥  : prob
prob=[1/21,2/21,3/21,4/21,5/21,6/21]
prob
```




    [0.048, 0.095, 0.143, 0.190, 0.238, 0.286]




```python
np.random.choice(dice, p=prob)
```




    1




```python
num_trial = 100
sample = np.random.choice(dice, num_trial, p=prob)
sample
```




    array([4, 6, 4, 5, 5, 6, 6, 3, 5, 6, 5, 6, 6, 2, 3, 1, 6, 5, 6, 3, 4, 5,
           3, 4, 3, 5, 5, 4, 4, 6, 4, 6, 5, 6, 5, 4, 6, 2, 6, 4, 5, 3, 4, 6,
           5, 5, 5, 3, 4, 5, 4, 4, 6, 4, 4, 6, 6, 2, 2, 4, 5, 1, 6, 4, 3, 2,
           2, 6, 3, 5, 4, 2, 4, 4, 6, 6, 1, 5, 3, 6, 6, 4, 2, 1, 6, 4, 4, 2,
           4, 1, 3, 6, 6, 6, 4, 5, 4, 3, 3, 4])




```python
freq, _ = np.histogram(sample, bins=6, range=(1,7))
pd.DataFrame({'frequency':freq,
             'rel.freq': freq/num_trial},
            index = pd.Index(np.arange(1,7), name = 'dice'))
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frequency</th>
      <th>rel.freq</th>
    </tr>
    <tr>
      <th>dice</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>27</td>
      <td>0.27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>19</td>
      <td>0.19</td>
    </tr>
    <tr>
      <th>6</th>
      <td>27</td>
      <td>0.27</td>
    </tr>
  </tbody>
</table>

</div>




```python
# 100ë²ˆì˜ ì‹œë„ëŠ” ì •í•´ì ¸ ìˆëŠ” í™•ë¥ ê³¼ëŠ” ì°¨ì´ê°€ ìˆë‹¤.

fig = plt.figure(figsize=(10, 6))
ax = fig.add_subplot(111)
ax.hist(sample, bins=6, range=(1, 7), density=True, rwidth=0.8)
# ì‹¤ì œì˜ í™•ë¥ ë¶„í¬ë¥¼ ê°€ë¡œì„ ìœ¼ë¡œ í‘œì‹œ
ax.hlines(prob, np.arange(1, 7), np.arange(2, 8), colors='gray')
# ë§‰ëŒ€ ê·¸ë˜í”„ì˜ [1.5, 2.5, ..., 6.5]ì— ëˆˆê¸ˆì„ í‘œì‹œ
ax.set_xticks(np.linspace(1.5, 6.5, 6))
# ì£¼ì‚¬ìœ„ ëˆˆì˜ ê°’ì€ [1, 2, 3, 4, 5, 6]
ax.set_xticklabels(np.arange(1, 7))
ax.set_xlabel('dice')
ax.set_ylabel('relative frequency')
plt.show()

```


![output_39_0](https://user-images.githubusercontent.com/75322297/149899483-b11b4625-7837-4570-9f65-f2cf5076159e.png)
    



```python
# 10000ë²ˆ ì‹œë„
num_trial = 10000
sample = np.random.choice(dice, size=num_trial, p=prob)

fig = plt.figure(figsize=(10, 6))
ax = fig.add_subplot(111)
ax.hist(sample, bins=6, range=(1, 7), density=True, rwidth=0.8)
ax.hlines(prob, np.arange(1, 7), np.arange(2, 8), colors='gray')
# ax.set_xticks(np.linspace(1.5, 6.5, 6))
# ax.set_xticklabels(np.arange(1, 7))
ax.set_xlabel('dice')
ax.set_ylabel('relative frequency')
plt.show()

```


![output_40_0](https://user-images.githubusercontent.com/75322297/149899529-c0204179-2a06-49f8-afbf-a94b18afe553.png)
    

**ì‹œë„í• ìˆ˜ë¡ ì‹¤ì œ í™•ë¥  ë¶„í¬ì— ê°€ê¹Œì›Œì§„ë‹¤.**

## ì¶”ë¡  í†µê³„ì—ì„œ í™•ë¥ 


```python
fig = plt.figure(figsize=(10, 6))
ax = fig.add_subplot(111)
ax.hist(scores, bins=100, range=(0, 100), density=True)
ax.set_xlim(20, 100)
ax.set_ylim(0, 0.042)
ax.set_xlabel('score')
ax.set_ylabel('relative frequency')
plt.show()
```


![output_43_0](https://user-images.githubusercontent.com/75322297/149899739-55f034e7-40fb-42fa-a209-e27544a20164.png)
    


## ì´ì‚°í˜•/ì—°ì†í˜• í™•ë¥ ë¶„í¬

![image](https://user-images.githubusercontent.com/75322297/149900482-763bcab5-c32a-430e-8aab-fa75a35c8fc9.png)

ì‚¬ì§„ ì¶œì²˜  : [https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=tjgml1343&logNo=221979604865](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=tjgml1343&logNo=221979604865)



<br>

## í†µê³„ì  ì¶”ë¡ (statistical inference)

* ëª¨ì§‘ë‹¨ì—ì„œ ì¶”ì¶œí•œ í‘œë³¸ì„ ì´ìš©í•´ ëª¨ì§‘ë‹¨ì˜ íŠ¹ì„±(ëª¨ìˆ˜)ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê³¼ì •
* ì¶”ì •, ê°€ì„¤ê²€ì •


```python
import numpy as np
import pandas as pd
from scipy import stats

%precision 3
np.random.seed(1111)
```


```python
import matplotlib.pyplot as plt
```

**ì°¸ê³ . ì •ê·œë¶„í¬ ê´€ë ¨ í•¨ìˆ˜ë“¤**

* stat.norm(í‰ê· , í‘œì¤€í¸ì°¨) : í‰ê· ê³¼ í‘œì¤€í¸ì°¨ì˜ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥ ë³€ìˆ˜ ìƒì„±
* .pdf(í™•ë¥ ë³€ìˆ˜) : ë°€ë„í•¨ìˆ˜ ê³„ì‚°
* .cdf(í™•ë¥ ë³€ìˆ˜) : ëˆ„ì ë¶„í¬í•¨ìˆ˜ P(<=í™•ë¥ ë³€ìˆ˜)
* .isf(alpha) : ìƒìœ„ alpha%ê°€ ë˜ëŠ” í™•ë¥ ë³€ìˆ˜ê°’ ë°˜í™˜
* .interval(alpha) : í™•ë¥ ì´ alphaê°€ ë˜ëŠ” ê°€ìš´ë° ë¶€ë¶„ì˜ êµ¬ê°„ ë°˜í™˜

## ì¶”ì •(estimation)

### ëª¨í‰ê· ì˜ êµ¬ê°„ì¶”ì •

**ë¬¸ì œ1**

í‘œì¤€ì •ê·œë¶„í¬ë¡œë¶€í„° í‘œë³¸ì„ ë½‘ì•„ 95% ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ëŠ” ê²ƒì„ 20ë²ˆ ë°˜ë³µí–ˆì„ ë•Œ, ëª‡ ê°œì˜ ì‹ ë¢°êµ¬ê°„ì´ ëª¨í‰ê· ì„ í¬í•¨í• ì§€ í™•ì¸


```python
# ì„±ì  ë°ì´í„°

df = pd.read_csv('./data/ch4_scores400.csv')
scores = np.array(df['score'])
```


```python
# ì„±ì ë°ì´í„° ëª¨ì§‘ë‹¨ì˜ í‰ê· ê³¼ ë¶„ì‚° ê³„ì‚°
p_mean = np.mean(scores)
p_var = np.var(scores)

p_mean, p_var
```




    (69.53, 206.6691)




```python
# ëª¨ì§‘ë‹¨ì˜ ë¶„í¬
xs = np.arange(101)
rv = stats.norm(p_mean, np.sqrt(p_var))
plt.plot(xs, rv.pdf(xs), color='gray') # í‰ê·  69.53, ë¶€ì‚° 206.67ì¸ ì •ê·œë¶„í¬
plt.hist(scores, bins=100, range = (0, 100), density=True)
plt.show()
```


![output_57_0](https://user-images.githubusercontent.com/75322297/149899839-b6a3d5b9-6d62-4f1c-a14f-9e3b3f4dcc80.png)
    



```python
# sample ë°ì´í„° ìƒì„±
n_sam = 10000
n = 20
samples = np.random.choice(scores, (n_sam, n))
samples[:5]
```




    array([[68, 75, 91, 60, 76, 70, 59, 56, 77, 54, 77, 60, 67, 86, 70, 54,
            52, 72, 57, 59],
           [97, 55, 61, 89, 80, 85, 70, 67, 77, 81, 48, 67, 56, 74, 94, 64,
            83, 65, 73, 71],
           [78, 67, 43, 63, 79, 46, 89, 79, 86, 85, 70, 57, 55, 63, 49, 83,
            83, 76, 62, 71],
           [74, 62, 48, 73, 45, 67, 58, 83, 49, 83, 67, 59, 66, 52, 54, 53,
            78, 80, 81, 57],
           [63, 83, 67, 75, 74, 73, 77, 78, 66, 86, 82, 67, 78, 54, 65, 92,
            64, 91, 61, 57]], dtype=int64)




```python
rv = stats.norm()
rv.isf(0.025)
```




    1.9599639845400545




```python
# ëª¨ë¶„ì‚°ì„ ì•„ëŠ” ê²½ìš° 95% ì‹ ë¢°êµ¬ê°„ : ì •ê·œë¶„í¬ë¥¼ ì´ìš©
rv = stats.norm()
n_samples = 20
n = 20
plt.vlines(p_mean, 0, 21)
for i in  range(n_samples):
    sample_ = samples[i]
    s_mean = np.mean(sample_)
    lcl = s_mean - rv.isf(0.025) * np.sqrt(p_var/n)
    ucl = s_mean + rv.isf(0.025) * np.sqrt(p_var/n)
#     ucl = s_mean - rv.isf(0.975) * np.sqrt(n_var/20)
    if lcl <= p_mean <= ucl:
        plt.scatter(s_mean, n_samples-i, color='gray')
        plt.hlines(n_samples-i, lcl, ucl, color='gray')
    else:
        plt.scatter(s_mean, n_samples-i, color='b')
        plt.hlines(n_samples-i, lcl, ucl, color='b')

plt.xticks([p_mean])
plt.xlabel('population mean')
plt.show()
```


![output_60_0](https://user-images.githubusercontent.com/75322297/149899866-40bb3d0f-8271-41c5-a391-245dcf68c873.png)
    



```python
# ëª¨ë¶„ì‚°ì„ ëª¨ë¥´ëŠ” ê²½ìš° 95% ì‹ ë¢°êµ¬ê°„ : t-ë¶„í¬ë¥¼ ì´ìš©
n = 20
alpha = 0.025
sample_ = samples[0]
s_mean = np.mean(sample_)
s_var = np.var(sample_)
rv = stats.t(df=n-1) #ììœ ë„ = n-1
lcl = s_mean - rv.isf(alpha) * np.sqrt(s_var/n)
ucl = s_mean + rv.isf(alpha) * np.sqrt(s_var/n)
lcl, ucl
```




    (61.94197882534913, 72.05802117465088)




```python
n_samples = 20
n = 20
rv = stats.t(df = n-1)
alpha = 0.025
plt.vlines(p_mean, 0, 21)
for i in range(n_samples):
    sample_ = samples[i]
    s_mean = np.mean(sample_)
    lcl = s_mean - rv.isf(alpha) * np.sqrt(s_var / n)
    ucl = s_mean + rv.isf(alpha) * np.sqrt(s_var / n)
#     ucl = s_mean - rv.isf(0.975) * np.sqrt(n_var / 20)
    if lcl <= p_mean <= ucl:
        plt.scatter(s_mean, n_samples-i, color = 'gray')
        plt.hlines(n_samples - i, lcl, ucl, color = 'gray')
    else:
        plt.scatter(s_mean, n_samples-i, color = 'b')
        plt.hlines(n_samples - i, lcl, ucl, color = 'b')

plt.xticks([p_mean])
plt.xlabel('population mean')
plt.show()
```


![output_62_0](https://user-images.githubusercontent.com/75322297/149899891-ed47f9b4-7c37-4071-8651-552dd61b43fb.png)
    


**ë¬¸ì œ2**  
ë§Œ 7ì„¸ ì–´ë¦°ì´ ì¤‘ ë¶€ëª¨ì˜ ë™ì˜ë¥¼ ì–»ì€ í•™ìƒ ì¤‘ 10ëª…ì„ í‘œë³¸ìœ¼ë¡œ ì¶”ì¶œ.  
ë¨¸ë¦¬ ë‘˜ë ˆë¥¼ ì¸¡ì •í•œ ê²°ê³¼ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ëª¨í‰ê· ì„ 95% ì‹ ë¢°ìˆ˜ì¤€ì—ì„œ ì‹ ë¢°êµ¬ê°„ì„ ì¶”ì •í•˜ì‹œì˜¤.



```python
# í‘œë³¸ ë°ì´í„°
data = [520, 498, 481, 512, 515, 542, 520, 518, 527, 526]
s_mean = np.mean(data)
s_var = np.var(data)
print(s_mean, s_var)

n = len(data)
print(n)

# t-ë¶„í¬ë¥¼ ì´ìš©í•œ ê²½ìš°
alpha = 0.025 # ì‹ ë¢°ìˆ˜ì¤€
rv = stats.t(df=n-1) #ììœ ë„ = n-1
lcl = s_mean - rv.isf(alpha) * np.sqrt(s_var/n)
ucl = s_mean + rv.isf(alpha) * np.sqrt(s_var/n)
lcl, ucl
```

    515.9 249.89000000000001
    10





    (504.59170283295526, 527.2082971670446)




```python
# ì •ê·œë¶„í¬ë¥¼ ì´ìš©í•œ ê²½ìš°

rv = stats.norm() #ììœ ë„ = n-1
alpha = 0.025
lcl = s_mean - rv.isf(alpha) * np.sqrt(s_var/n)
ucl = s_mean + rv.isf(alpha) * np.sqrt(s_var/n)
lcl, ucl
```




    (506.10233627489055, 525.6976637251095)



---

## í†µê³„ì  ê°€ì„¤ê²€ì •(test) 

**ë¬¸ì œ(p.294)**  
ê°ìíŠ€ê¹€ ë¬´ê²Œê°€ í‰ê·  130gìœ¼ë¡œ ì•Œë ¤ì ¸ìˆë‹¤.


```python
# ê°ì ë¬´ê²Œ ì¸¡ì •ë°ì´í„°
df = pd.read_csv('./data/ch11_potato.csv')
sample = np.array(df['ë¬´ê²Œ'])
sample
```




    array([122.02, 131.73, 130.6 , 131.82, 132.05, 126.12, 124.43, 132.89,
           122.79, 129.95, 126.14, 134.45, 127.64, 125.68])




```python
# í‘œë³¸ í‰ê·  í™•ì¸
s_mean = np.mean(sample)
s_mean
```




    128.4507142857143




```python
# í‘œë³¸ ë¶„ì‚° í™•ì¸
s_var = np.var(sample)
s_var
```




    14.735449489795883




```python
# ëª¨ë¶„ì‚° = 9
rv = stats.norm(130, np.sqrt(9/14))
rv.isf(0.95) 
# í‰ê· ì´ 130ì´ì˜€ì„ ë•Œ, 0.95ë¶€ë¶„ì´ 128.6811831...
# í•˜ì§€ë§Œ í‘œë³¸ì˜ í‰ê· ì´ 128.45 ì´ë¯€ë¡œ  ê°ìíŠ€ê¹€ì˜ í‰ê·  ë¬´ê²Œê°€ 130gì´ë¼ëŠ” ì£¼ì¥ì— ë°˜ëŒ€í•  ìˆ˜ ìˆë‹¤.
```




    128.68118313069039



### pê°’ì€ ëˆ„ì  ë¶„í¬ í•¨ìˆ˜ë¡œ êµ¬í•  ìˆ˜ ìˆìŒ

#### ê²€ì •í†µê³„ëŸ‰ zëŠ” ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•˜ì

* ìœ ì˜ ìˆ˜ì¤€ì€ 0.05(5%)ë¡œ ì„¤ì •


```python
# ê²€ì • í†µê³„ëŸ‰ Z
Z = (s_mean - 130) / np.sqrt(9/14)
Z
# ê²€ì • í†µê³„ëŸ‰ = -1.9322..
```




    -1.932298779026813




```python
# p-value
rv.cdf(Z)
```




    0.0



* pê°’ì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ” ê°€ì„¤ ê²€ì •
  1. ê°€ì„¤ì„ ì„¸ìš´ë‹¤.
  2. ìœ ì˜ìˆ˜ì¤€ì„ ê²°ì •
  3. ê²€ì •í†µê³„ëŸ‰ì„ ê³„ì‚°
  4. pê°’ì„ ê³„ì‚°
  5. pê°’ì´ ìœ ì˜ìˆ˜ë¶„ë³´ë‹¤ í¬ë‹¤ë©´ ê·€ë¬´ê°€ì„¤ì±„íƒ  
     ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°


```python
rv=stats.norm()
rv.isf(0.95) # isf ëŠ” í™•ë¥ ì— ëŒ€í•œ xê°’ì„ ê³„ì‚°
```




    -1.6448536269514722



### ë‹¨ì¸¡ê²€ì •ê³¼ ì–‘ì¸¡ê²€ì •ì—ì„œëŠ” ê¸°ê°ì—­ì´ ë‹¤ë¥´ë‹¤.


```python
# ê²€ì • í†µê³„ëŸ‰
Z = (s_mean - 130) / np.sqrt(9/14)
Z
```




    -1.932298779026813




```python
# ì–‘ì¸¡ê²€ì •, ì„ê³„ê°’ : í‘œì¤€ ì •ê·œë¶„í¬ì˜ 95% êµ¬ê°„ì— ë”°ë¼ êµ¬í•  ìˆ˜ ìˆìŒ
rv=stats.norm()
rv.interval(0.95) # ìœ ì˜ìˆ˜ì¤€ 0.95ì— ì–‘ìª½ì˜ ê¸°ê°ì—­ì˜ ìœ„ì¹˜ë¼ê³  ìƒê°í•˜ë©´ ë ë“¯
```




    (-1.959963984540054, 1.959963984540054)



* ì„ê³—ê°’ê³¼ ê²€ì • í†µê³„ëŸ‰ì„ ë¹„êµí•´ ë³´ë©´ ê²€ì •í†µê³„ëŸ‰ì´ ì±„íƒì—­ì— ë“¤ì–´ ìˆë‹¤. => ê·€ë¬´ê°€ì„¤ì´ ê¸°ê°ë˜ì§€ ì•ŠëŠ”ë‹¤.


```python
# ì–‘ì¸¡ê²€ì •ì˜ pê°’
rv.cdf(Z)*2 #cdfëŠ” xê°€ ì£¼ì–´ì§€ë©´ yê°’ì„ ë°˜í™˜
```




    0.05332263904625327



### ê°€ì„¤ê²€ì •ì—ì„œì˜ ë‘ê°€ì§€ ì˜¤ë¥˜

* ì œ 1ì¢… ì˜¤ë¥˜
  * ì‹¤ì œë¡œ 'í‰ê· ì´ 130g'ì¸ë°ë„ 'í‰ê· ì€ 130gë³´ë‹¤ ì‘ë‹¤'ë¼ëŠ” ê²°ë¡ ì„ ë‚´ë¦¬ëŠ” ìƒí™©
  * ë³¸ë˜ ê²€ì¶œí•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒì„ ê²€ì¶œí•œ ê²ƒì´ë¯€ë¡œ ì˜¤íƒ(false negative)
  * ìœ„í—˜ë¥  : ì œ 1ì¢… ì˜¤ë¥˜ë¥¼ ë²”í•˜ëŠ” í™•ë¥  a

* ì œ 2ì¢… ì˜¤ë¥˜
  * ì‹¤ì œë¡œ 'í‰ê· ì´ 130gë³´ë‹¤ ì‘ë‹¤'ì¸ë°ë„ 'í‰ê· ì€ 130gë³´ë‹¤ ì‘ë‹¤'ë¼ëŠ” ê²°ë¡ ì„ ì–»ì„ ìˆ˜ ì—†ëŠ” ìƒí™©
  * ë³¸ë˜ ê²€ì¶œí•´ì•¼ í•˜ëŠ” ê²ƒì„ ê²€ì¶œí•˜ì§€ ëª»í–ˆìœ¼ë¯€ë¡œ ë¯¸íƒ(false negative)

### ëª¨ë¶„ì‚°ì„ ì•„ëŠ” ê²½ìš°


```python
# ëª¨ë¶„ì‚°ì„ ì•„ëŠ” ê²½ìš° ëª¨í‰ê· ì— ëŒ€í•œ ì–‘ì¸¡ê²€ì •ì„ ìœ„í•œ í•¨ìˆ˜
# ì •ê·œë¶„í¬ë¥¼ ê¸°ë°˜

def pmean_test(sample, mean0, p_var, alpha=0.05):
    s_mean = np.mean(sample)
    n = len(sample)
    rv = stats.norm()
    interval = rv.interval(1-alpha)

    z = (s_mean - mean0) / np.sqrt(p_var/n)
    if interval[0] <= z <= interval[1]:
        print('ê·€ë¬´ê°€ì„¤ì„ ì±„íƒ')
    else:
        print('ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°')

    if z < 0:
        p = rv.cdf(z) * 2
    else:
        p = (1 - rv.cdf(z)) * 2
    print(f'pê°’ì€ {p:.3f}')

```

### ëª¨ë¶„ì‚°ì„ ì•Œì§€ ëª»í•¨


```python
# ì–‘ì¸¡ê²€ì •, t-ë¶„í¬ë¥¼ ì´ìš©

def pmean_test(sample, mean0, alpha=0.05):
    s_mean = np.mean(sample)
    u_var = np.var(sample, ddof=1)
    n = len(sample)
    rv = stats.t(df=n-1)
    interval = rv.interval(1-alpha) # ì„ê³„ê°’ ê³„ì‚°

    t = (s_mean - mean0) / np.sqrt(u_var/n)
    if interval[0] <= t <= interval[1]:
        print('ê·€ë¬´ê°€ì„¤ì„ ì±„íƒ')
    else:
        print('ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°')

    if t < 0:
        p = rv.cdf(t) * 2 # p-value
    else:
        p = (1 - rv.cdf(t)) * 2
    print(f'pê°’ì€ {p:.3f}')

```


```python
pmean_test(sample, 130)
```

    ê·€ë¬´ê°€ì„¤ì„ ì±„íƒ
    pê°’ì€ 0.169



```python
# scipy.statsì— êµ¬í˜„
t, p = stats.ttest_1samp(sample,130)
t, p # í†µê³„ëŸ‰, p-value
```




    (-1.4551960206404198, 0.16933464230414275)



---

## t-test(t-ê²€ì •)

* one sample t-test
  * ì •ê·œì„± ê°€ì •
  * stats.ttest_1samp()
* two sample t-test
  * ì •ê·œì„±, ë“±ë¶„ì‚°ì„± ê°€ì •
  * ë“±ë¶„ì‚° stats.ttest_ind(a,b, equal_var=True)
  * ì´ë¶„ì‚° stats.ttest_ind(a,b, equal_var=False)
  * ì •ê·œì„± ë§Œì¡±í•˜ì§€ ì•ŠëŠ” ê²½ìš° : Mann-Whitney rank test
    * stats.mannwhitneyu(a,b)

* paired sample t-test
  * ì •ê·œì„± ë§Œì¡± : stats.ttest_1samp(a,b, popmean=ëª¨ì§‘ë‹¨í‰ê· )
  * ì •ê·œì„± ë§Œì¡±í•˜ì§€ ì•ŠëŠ” ê²½ìš° : Wilcoxon signed-rank test
    * stats.wilcoxon(before, after)

### ëŒ€ì‘í‘œë³¸ t-test

- ê·¼ë ¥ ìš´ë™ ì „í›„ ì§‘ì¤‘ë ¥ ë¹„êµ
- ê·€ë¬´ê°€ì„¤ : ì „ == í›„
- ëŒ€ë¦½ê°€ì„¤ : ì „ != í›„


```python
# ëŒ€ì‘í‘œë³¸ ìƒ˜í”Œë°ì´í„°
data = pd.read_csv('./data/ch11_training_rel.csv')
print(data.shape)
data.head()
```

    (20, 2)





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ì „</th>
      <th>í›„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59</td>
      <td>41</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>55</td>
      <td>68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61</td>
      <td>59</td>
    </tr>
    <tr>
      <th>4</th>
      <td>59</td>
      <td>84</td>
    </tr>
  </tbody>
</table>

</div>




```python
# ê¸°ìˆ  í†µê³„
data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ì „</th>
      <th>í›„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>52.850000</td>
      <td>58.250000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.295346</td>
      <td>11.964311</td>
    </tr>
    <tr>
      <th>min</th>
      <td>45.000000</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>50.500000</td>
      <td>51.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>52.000000</td>
      <td>58.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>55.500000</td>
      <td>65.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>61.000000</td>
      <td>84.000000</td>
    </tr>
  </tbody>
</table>

</div>




```python
# ë°ì´í„°ì˜ ì‹œê°í™” : ìƒìê·¸ë¦¼í‘œ
import matplotlib.pyplot as plt

plt.boxplot(data)
plt.show()
```


![output_99_0](https://user-images.githubusercontent.com/75322297/149899979-d03b113b-4cfd-48d7-b2db-07f8fe888315.png)
    


#### ì •ê·œì„± ê²€ì •


```python
# ì •ê·œì„± ê²€ì •
stats.shapiro(data.ì „)
```




    ShapiroResult(statistic=0.9670043587684631, pvalue=0.6907904148101807)




```python
stats.shapiro(data.í›„)
```




    ShapiroResult(statistic=0.9786623120307922, pvalue=0.9156785011291504)




```python
diff = data.ì „ - data.í›„
diff
```




    0     18
    1    -11
    2    -13
    3      2
    4    -25
    5      8
    6     -5
    7     -3
    8    -19
    9    -18
    10    -6
    11    -8
    12     3
    13    13
    14    -2
    15    -6
    16   -16
    17   -16
    18    -2
    19    -2
    dtype: int64




```python
stats.shapiro(diff)
```




    ShapiroResult(statistic=0.9785391688346863, pvalue=0.9138697981834412)




```python
plt.boxplot(diff)
plt.show()
```


![output_105_0](https://user-images.githubusercontent.com/75322297/149900015-7a82f93b-03b2-4135-9b30-5db668e04635.png)
    


#### ëŒ€ì‘í‘œë³¸ t ê²€ì • ìˆ˜í–‰


```python
stats.ttest_1samp(data.ì „-data.í›„, 0)
```




    Ttest_1sampResult(statistic=-2.204154108716127, pvalue=0.04004419061842953)



=> ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ë¯€ë¡œ, ê·¼ë ¥ìš´ë™ì´ ì§‘ì¤‘ë ¥ì— ì˜í–¥ì´ ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.

### ë…ë¦½ í‘œë³¸ t-test

* ë…ë¦½ëœ ë‘ ì§‘ë‹¨ì˜ í‰ê·  ë¹„êµ
* ê·€ë¬´ê°€ì„¤ : ë‘ ì§‘ë‹¨ì˜ í‰ê· ì€ ê°™ë‹¤.
* ëŒ€ë¦½ê°€ì„¤ : ë‘ ì§‘ë‹¨ì˜ í‰ê· ì€ ì°¨ì´ê°€ ìˆë‹¤.

* ë°˜ë³„ ì ìˆ˜ ì°¨ê°€ ìˆëŠ”ì§€?
* ë‘ ì§‘ë‹¨ì€ ì •ê·œì„±ì„ ë„ì–´ì•¼ í•œë‹¤, ë‘ ì§‘ë‹¨ì˜ ë¶„ì‚°ì— ë”°ë¼ ë‹¤ë¥¸ ê²€ì •ì‹ì„ ì‚¬ìš©í•œë‹¤.

#### ì„ í–‰ì¡°ê±´

* ë…ë¦½ì„± : ë‘ ê·¸ë£¹ì€ ì„œë¡œ ë…ë¦½ì ì´ì–´ì•¼ í•¨
* ì •ê·œì„± : ë°ì´í„°ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¼ì•¼ í•¨
  * ë§Œì•½, ì •ê·œì„±ì„ ë„ì§€ ì•Šìœ¼ë©´ ë¹„ëª¨ìˆ˜ì ì¸ ë°©ë²•ì¸ ë¶€í˜¸ê²€ì •ì„ ì§„í–‰
* ë“±ë¶„ì‚°ì„± : ë‘ ê·¸ë£¹ì˜ ë°ì´í„°ì— ëŒ€í•œ ë¶„ì‚°ì´ ê°™ì•„ì•¼ í•¨
  * Leveneì˜ ë“±ë¶„ì‚° ê²€ì •

**ì˜ˆì œ ë°ì´í„°**

- ë‘ í•™ê¸‰(A,B)ì— ê·¼ë ¥ìš´ë™ì„ ìˆ˜í–‰í•˜ì—¬ ì§‘ì¤‘ë ¥ í…ŒìŠ¤íŠ¸
- ê·€ë¬´ê°€ì„¤ : ë‘ í•™ê¸‰ì˜ ì§‘ì¤‘ë ¥ ì°¨ì´ê°€ ì—†ë‹¤.
- ëŒ€ë¦½ê°€ì„¤ : ë‘ í•™ê¸‰ì˜ ì§‘ì¤‘ë ¥ ì°¨ì´ê°€ ìˆë‹¤.(ì–‘ì¸¡ê²€ì •)


```python
data = pd.read_csv('./data/ch11_training_ind.csv')
data.shape
```




    (20, 2)




```python
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>47</td>
      <td>49</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>54</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60</td>
      <td>48</td>
    </tr>
    <tr>
      <th>4</th>
      <td>39</td>
      <td>51</td>
    </tr>
  </tbody>
</table>

</div>




```python
data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>48.750000</td>
      <td>52.050000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.711145</td>
      <td>5.020746</td>
    </tr>
    <tr>
      <th>min</th>
      <td>37.000000</td>
      <td>41.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>44.750000</td>
      <td>49.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>48.500000</td>
      <td>52.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>53.000000</td>
      <td>54.250000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>64.000000</td>
      <td>64.000000</td>
    </tr>
  </tbody>
</table>

</div>




```python
plt.boxplot(data)
plt.show()
```


![output_115_0](https://user-images.githubusercontent.com/75322297/149900038-5abad8bf-51e2-411c-93a7-708233823cba.png)
    

**1. ì •ê·œì„± ê²€ì •**


```python
# ì •ê·œì„± ê²€ì •
stats.shapiro(data.A)
```




    ShapiroResult(statistic=0.9685941338539124, pvalue=0.7249506711959839)




```python
stats.shapiro(data.B)
```




    ShapiroResult(statistic=0.9730017781257629, pvalue=0.8165717720985413)



=> ë‘ í•™ê¸‰ì˜ ë°ì´í„°ëŠ” ëª¨ë‘ ì •ê·œì„±ì„ ë§Œì¡±

**2. ë“±ë¶„ì‚°ì„± ê²€ì •**  

- ê·€ë¬´ê°€ì„¤ : ë‘ ì§‘ë‹¨ì˜ ë¶„ì‚°ì´ ê°™ë‹¤.


```python
stats.levene(data.A, data.B)
```




    LeveneResult(statistic=2.061573118077718, pvalue=0.15923550057222613)



=> pê°’ì´ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰, ë‘ ì§‘ë‹¨ì˜ ë¶„ì‚°ì€ ê°™ë‹¤.(ë“±ë¶„ì‚°)

**3. ë…ë¦½í‘œë³¸ t-ê²€ì •**


```python
# equal_varëŠ” ë¶„ì‚°ì´ ê°™ë‹ˆ? ì•ˆê°™ë‹ˆ?
# Falseë¡œ ì§€ì •ëœ ê²½ìš° ì›°ì¹˜ ë°©ë²• ì‚¬ìš©
stats.ttest_ind(data.A, data.B, equal_var=True)
```




    Ttest_indResult(statistic=-1.7608157246524712, pvalue=0.08631600572195147)



=> ê·€ë¬´ê°€ì„¤ ì±„íƒ : ë‘ ì§‘ë‹¨ì˜ ì§‘ì¤‘ë ¥ ì°¨ì´ê°€ ì—†ë‹¤.


```python
stats.ttest_ind(data.A, data.B, equal_var=False)
```




    Ttest_indResult(statistic=-1.760815724652471, pvalue=0.08695731107259361)



### ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ì•ŠëŠ” ê²½ìš°

1. ëŒ€ì‘í‘œë³¸ t-testëŠ” ìœŒì½•ìŠ¨ ë¶€í˜¸ìˆœìœ„ê²€ì •ì„ ì ìš©
   * stats.wilcoxon(ì „, í›„)

2. ë…ë¦½í‘œë³¸ t-testëŠ” ë§¨íœ˜íŠ¸ë‹ˆ Uê²€ì • ì ìš©
   * stats.mannwhitneyu(A, B, alternative='two-sided') <- two-sidedëŠ” ì–‘ì¸¡ê²€ì •


```python
# ì•ì˜ 20ëª… í•™ìƒì˜ ì§‘ì¤‘ë ¥ í…ŒìŠ¤íŠ¸ ëŒ€ì‘í‘œë³¸ ë°ì´í„°
stats.wilcoxon(diff)
```




    WilcoxonResult(statistic=49.5, pvalue=0.03623390197753906)




```python
# ë‘ í•™ê¸‰ì˜ í•™ìƒë“¤ì˜ ì§‘ì¤‘ë ¥ í…ŒìŠ¤íŠ¸ ë°ì´í„°(ë…ë¦½í‘œë³¸)
stats.mannwhitneyu(data.A, data.B)
```




    MannwhitneyuResult(statistic=130.0, pvalue=0.02974305583063662)



---

<br>

## ì¹´ì´ì œê³± ê²€ì •

- ë²”ì£¼í˜• ë°ì´í„°ì— ëŒ€í•˜ì—¬
- ì¹´ì´ì œê³± ë¶„í¬ ê·¼ê±°

1. ì í•©ë„ ê²€ì • : í•œ í‘œë³¸ë°ì´í„°ê°€ ì–´ë–¤ ë¶„í¬ë¥¼ í•˜ëŠ”ì§€?
2. ë™ì§ˆì„± ê²€ì • : ë‘ ë²”ì£¼í˜• ë°ì´í„°ê°€ ë™ì¼í•œ ë¶„í¬ë¥¼ í•˜ëŠ”ì§€?
3. ë…ë¦½ì„± ê²€ì • : ë‘ ë²”ì£¼í˜• ë°ì´í„°ê°€ ì„œë¡œ ê´€ë ¨ì„± ìˆëŠ”ì§€(ë…ë¦½)

**ë…ë¦½ì„± ê²€ì •**

* ë‘ ë²”ì£¼í˜• ë³€ìˆ˜ê°€ ì„œë¡œ ë…ë¦½ì ì¸ì§€ ê²€ì •
  * ê·€ë¬´ê°€ì„¤ : ë‘ ë³€ìˆ˜ê°€ ì„œë¡œ ë…ë¦½
  * ëŒ€ë¦½ê°€ì„¤ : ë‘ ë³€ìˆ˜ê°€ ì„œë¡œ ì¢…ì†
* êµì°¨í…Œì´ë¸”ë¡œ ì‹œê°í™”


```python
# ëª¨ë“ˆë“¤ í˜¸ì¶œ!!
import numpy as np
import pandas as pd
from scipy import stats

%precision 3
np.random.seed(1111)
```


```python
# ì˜ˆì œ ë°ì´í„°
data = pd.read_csv('./data/ch11_ad.csv')
data.shape # ë°ì´í„° í¬ê¸° í™•ì¸
```




    (1000, 2)




```python
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ê´‘ê³ </th>
      <th>êµ¬ì…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B</td>
      <td>í•˜ì§€ ì•Šì•˜ë‹¤</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>í•˜ì§€ ì•Šì•˜ë‹¤</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>í–ˆë‹¤</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>í–ˆë‹¤</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>í•˜ì§€ ì•Šì•˜ë‹¤</td>
    </tr>
  </tbody>
</table>

</div>




```python
# êµì°¨í‘œ ìƒì„±
cross = pd.crosstab(data.ê´‘ê³ , data.êµ¬ì…)
cross
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>êµ¬ì…</th>
      <th>í•˜ì§€ ì•Šì•˜ë‹¤</th>
      <th>í–ˆë‹¤</th>
    </tr>
    <tr>
      <th>ê´‘ê³ </th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>351</td>
      <td>49</td>
    </tr>
    <tr>
      <th>B</th>
      <td>549</td>
      <td>51</td>
    </tr>
  </tbody>
</table>

</div>




```python
# ì¹´ì´ì œê³± ë…ë¦½ì„±ê²€ì •
stat, p, df, exp_tab = stats.chi2_contingency(cross, correction = False)
```


```python
stat # í†µê³„ëŸ‰
```




    3.75




```python
p # p-value
```




    0.052807511416113395




```python
df # ììœ ë„
```




    1




```python
exp_tab
```




    array([[360.,  40.],
           [540.,  60.]])

