---
layout: posts
comments: true
title: "[Pandas]내가 보려고 올린 Pandas 정리5"
categories: Python
tag: [python, 파이썬, pandas, 판다스, pd, 패키지]
toc: true
toc_sticky: true
date: 2022-01-14
last_modified_at: 2022-01-14

---

**[Noitce]** 고쳐야하거나 틀린 것이 있으면 말씀해주세요!
{: .notice--info}



<br>



## Pandas merge, join, concat
- [판다스 사이트](https://pandas.pydata.org/docs/user_guide/merging.html)
- 두 개 이상의 데이터프레임을 병합해주는 **병합(merge)**이나 **연결(concate)**이 있다.
- merge(), join(), concat()


```python
# 모듈 설치
import pandas as pd
import numpy as np
import random
```


```python
# output에 여러가지 결과가 나올 수 있도록 한다.
from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity="all"
```

## 1. 데이터 병합

### 1) merge()

- 두 데이터 프레임의 공통 열(column)이나 인덱스(index)를 기준으로 합침
- **key** : 기준이 되는 열

#### 사용방식

- df.merge(df1) : 두 df를 병합시킴
- 기본은 inner join : 양쪽에 동일하게 존재하는 키만 표시
- key : 기준열
  -  실제 데이터 필드거나 행 인덱스 일 수 있다.
- 병합방식
  - inner join :  양쪽 데이터프레임에서 모두 키가 존재하는 데이터만 표시
  - outer join :  한쪽에만 키가 존재하면 데이터를 표시
  - 병합방식(매개변수 how) : how=inner(default), how=outer 


![](C:\Users\513eh\Downloads\img\join_all.PNG)

![](C:\Users\513eh\Downloads\img\join_inout.PNG)

**예제1**

- 축구 선수의 정보를 담고 있는 데이터 프레임


```python
df1 = pd.DataFrame({'선수번호':[1,2,3,4,5,6,7], 
                   '이름':['이운재','박지성','손흥민','차범근','김남일','홍명보','김민재']},
                   columns = ['선수번호','이름'])
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>박지성</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>손흥민</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>차범근</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>김남일</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>홍명보</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>김민재</td>
    </tr>
  </tbody>
</table>

</div>



- 선수 연봉 정보 데이터 프레임


```python
# 예제 df 생성 - 예금 정보 df
df2 = pd.DataFrame({'선수번호':[1, 1, 5, 6, 8, 1], 
                   '연봉(억)':[10, 20, 30, 40, 200, 5]},
                   columns = ['선수번호','연봉(억)'])
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>200</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

</div>



**merge 명령으로 두 데이터프레임을 병합하는 문법**

- merge(df1, df2, how, on, left_on, right_on, left_index, right_index)

- 모든 인수 생략(병합 df를 제외한) 공통 이름을 갖고 있는 열
- '고객번호'가 키가 됨
- 양쪽에 모두 존재하는 키의 data만 보여주는 **`inner join`** 방식을 사용
  - pandas.merge(df1, df2)
  - df1.merge(df2)


```python
df1.head(1)
df2.tail(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

</div>



**df1.merge(df2)**

- 기준 데이터프레임은 df1


```python
df1.merge(df2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>이운재</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>이운재</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>김남일</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>홍명보</td>
      <td>40</td>
    </tr>
  </tbody>
</table>

</div>



**pd.merge(데이터프레임1, 데이터프레임2)**

- 기준이 되는 DF는 왼쪽에 위치한다.


```python
# 왼쪽에 기준 데이터 프레임(df1)
pd.merge(df1,df2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>이운재</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>이운재</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>김남일</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>홍명보</td>
      <td>40</td>
    </tr>
  </tbody>
</table>

</div>



### how = '인수'

**merge( , how = 'outer')**

- how = inner/outer/left/right
  - how=left : 왼쪽 df에 있는 모든 키의 데이터는 표시
  - how=right : 오른쪽 df 에 있는 모든 키의 데이터는 표시

- outer join
  - 키 값이 한쪽에만 있어도 모든 데이터를 보여준다.
  - 다른 데이터프레임에 데이터가 존재하지 않으면 NaN으로 표시됨


```python
pd.merge(df1, df2, how='outer')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>이운재</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>이운재</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>박지성</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>손흥민</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4</td>
      <td>차범근</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5</td>
      <td>김남일</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6</td>
      <td>홍명보</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7</td>
      <td>김민재</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8</td>
      <td>NaN</td>
      <td>200.0</td>
    </tr>
  </tbody>
</table>

</div>



- left join


```python
pd.merge(df1, df2, how='left')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>이운재</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>이운재</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>박지성</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>손흥민</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4</td>
      <td>차범근</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5</td>
      <td>김남일</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6</td>
      <td>홍명보</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7</td>
      <td>김민재</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>

</div>



- right join


```python
pd.merge(df1, df2, how='right')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선수번호</th>
      <th>이름</th>
      <th>연봉(억)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>이운재</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>이운재</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>이운재</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>김남일</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>홍명보</td>
      <td>40</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8</td>
      <td>NaN</td>
      <td>200</td>
    </tr>
  </tbody>
</table>

</div>



### 동일한 키 값이 있는 경우

- 키값이 같은 데이터가 여러개 있는 경우에는 있을 수 있는 모든 경우의 수를 따져서 조합을 만들어 낸다.

**예제2. 데이터프레임 생성**

- 데이터프레임1 


```python
# 예제 df 생성 
# 열: 신발종류, 사이즈
df1 = pd.DataFrame({
    '신발종류':['nike','nike','adidas','adidas'],
    '사이즈':[240, 230, 250, 230]},
    columns=['신발종류','사이즈'])
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>사이즈</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>240</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nike</td>
      <td>230</td>
    </tr>
    <tr>
      <th>2</th>
      <td>adidas</td>
      <td>250</td>
    </tr>
    <tr>
      <th>3</th>
      <td>adidas</td>
      <td>230</td>
    </tr>
  </tbody>
</table>

</div>



- 데이터프레임2


```python
# 열 : 신발종류, 가격(만원)
df2 = pd.DataFrame({
    '신발종류': ['nike','adidas','adidas','puma'],
    '가격(만원)':[7,5,6,6]},
    columns=['신발종류','가격(만원)'])
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>가격(만원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>adidas</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>adidas</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>puma</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

</div>



- df1과 df2 를 병합


    - 위 데이터에서 키 값 setosa에 대해
        - df1에는 1.4와 1.3 2개의 데이터가 있고
        - df2에는 0.4라는 1개의 데이터가 있으므로
        - 병합 데이터에는 setosa가 (1.4,0.4)(1.3,0.4)의 2 경우가 표현된다.


    - 키값 virginica의 경우에는 df1에 2개 df2에 2개의 데이터가 있으므로
        - 2개와 2개의 조합에 의해 4개의 데이터가 표현된다.


```python
#양쪽 데이터프레임에서 공통된 키만 표현

df1.head(1)
df2.head(1)
pd.merge(df1,df2)
pd.merge(df1,df2, how='left')
pd.merge(df1,df2, how='right')
pd.merge(df1,df2, how='outer')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>사이즈</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>240</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>가격(만원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>사이즈</th>
      <th>가격(만원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>240</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nike</td>
      <td>230</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>adidas</td>
      <td>250</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>adidas</td>
      <td>250</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>adidas</td>
      <td>230</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>adidas</td>
      <td>230</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>사이즈</th>
      <th>가격(만원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>240</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nike</td>
      <td>230</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>adidas</td>
      <td>250</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>adidas</td>
      <td>250</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>adidas</td>
      <td>230</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>adidas</td>
      <td>230</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>사이즈</th>
      <th>가격(만원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>240.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nike</td>
      <td>230.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>adidas</td>
      <td>250.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>adidas</td>
      <td>230.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>adidas</td>
      <td>250.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>adidas</td>
      <td>230.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>puma</td>
      <td>NaN</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신발종류</th>
      <th>사이즈</th>
      <th>가격(만원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nike</td>
      <td>240.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nike</td>
      <td>230.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>adidas</td>
      <td>250.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>adidas</td>
      <td>250.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>adidas</td>
      <td>230.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>adidas</td>
      <td>230.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>puma</td>
      <td>NaN</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

</div>



### merge()의 on 인수를 사용하여 기준열 설정을 통한 병합

**key**

- 두 데이터 프레임에서 이름이 같은 열은 모두 키가 될 수 있다.
- 열이름이 같아도 키로 사용할 수 없는 열이 있으면 **on 인수로 기준열을 명시**해야 한다.

**예제3.**


```python
# 예제 df
df1 = pd.DataFrame({
    '고객명':['동준','동준','풍호'],
    '날짜' : ['2022-01-14','2022-01-15','2021-01-14'],
    '데이터':[1000, 2000, 30000]
})
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객명</th>
      <th>날짜</th>
      <th>데이터</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>동준</td>
      <td>2022-01-14</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>동준</td>
      <td>2022-01-15</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>풍호</td>
      <td>2021-01-14</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>

</div>




```python
df2 = pd.DataFrame({
    '고객명':['동준','풍호'],
    '데이터':['여자','남자']
})
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객명</th>
      <th>데이터</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>동준</td>
      <td>여자</td>
    </tr>
    <tr>
      <th>1</th>
      <td>풍호</td>
      <td>남자</td>
    </tr>
  </tbody>
</table>

</div>



**기준열을 직접 지정 : on=기준열 이름**

- 반환 결과에 동일 필드명이 있을 경우에는 필드명_x, 필드명_y로 필드명을 변경해서 표현


```python
pd.merge(df1, df2, on='고객명')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객명</th>
      <th>날짜</th>
      <th>데이터_x</th>
      <th>데이터_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>동준</td>
      <td>2022-01-14</td>
      <td>1000</td>
      <td>여자</td>
    </tr>
    <tr>
      <th>1</th>
      <td>동준</td>
      <td>2022-01-15</td>
      <td>2000</td>
      <td>여자</td>
    </tr>
    <tr>
      <th>2</th>
      <td>풍호</td>
      <td>2021-01-14</td>
      <td>30000</td>
      <td>남자</td>
    </tr>
  </tbody>
</table>

</div>



**키가 되는 기준열 이름이 두 데이터 프레임에서 다르게 나타나는 경우**

- **left_on, right_on 인수**를 사용해서 기준열을 명시해야 함

**예제4.**


```python
df1=pd.DataFrame({
    '이름' :['동준','굿전','굿전'],
    '성적' :[100,90,80]
})
df2 = pd.DataFrame({
    '성명' :['동준','동준','굿전'],
    '성적2':[95,85,90]
})
df1.head(1)
df2.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>동준</td>
      <td>100</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>성명</th>
      <th>성적2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>동준</td>
      <td>95</td>
    </tr>
  </tbody>
</table>

</div>




```python
pd.merge(df1, df2, left_on='이름', right_on='성명')
# 양쪽에서 기준이되는 열의 이름이 다르기 때문에 on인수를 두번사용
# 출력결과는 양쪽 필드 명이 다르기 때문에 기준열이 모두나타난다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>성적</th>
      <th>성명</th>
      <th>성적2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>동준</td>
      <td>100</td>
      <td>동준</td>
      <td>95</td>
    </tr>
    <tr>
      <th>1</th>
      <td>동준</td>
      <td>100</td>
      <td>동준</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <td>굿전</td>
      <td>90</td>
      <td>굿전</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>굿전</td>
      <td>80</td>
      <td>굿전</td>
      <td>90</td>
    </tr>
  </tbody>
</table>

</div>



### 인덱스 기준으로 병합

: 일반 데이터 열이 아닌 인덱스를 기준으로 merge 할수도 있음


- 인덱스를 기준열로 사용하려면
  - left_index = True 또는
  - right_index = True 설정을 하게 됨

**예제5. 데이터프레임의 인덱스를 기준열로 사용하는 경우**


```python
df1 = pd.DataFrame({
    '도시': ['서울','서울','서울','부산','부산'],
    '연도': [2000, 2005, 2010, 2000, 2005],
    '인구': [9853972, 9762546, 9631482, 3655437, 3512547]    
})

df2=pd.DataFrame(
    np.arange(12).reshape((6,2)),
    index=[['부산','부산','서울','서울','서울','서울'],
          [2000, 2005, 2000, 2005, 2010, 2015]],
    columns=['데이터1','데이터2']
)

df1
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>도시</th>
      <th>연도</th>
      <th>인구</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2000</td>
      <td>9853972</td>
    </tr>
    <tr>
      <th>1</th>
      <td>서울</td>
      <td>2005</td>
      <td>9762546</td>
    </tr>
    <tr>
      <th>2</th>
      <td>서울</td>
      <td>2010</td>
      <td>9631482</td>
    </tr>
    <tr>
      <th>3</th>
      <td>부산</td>
      <td>2000</td>
      <td>3655437</td>
    </tr>
    <tr>
      <th>4</th>
      <td>부산</td>
      <td>2005</td>
      <td>3512547</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>데이터1</th>
      <th>데이터2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">부산</th>
      <th>2000</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">서울</th>
      <th>2000</th>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>

</div>




```python
pd.merge(df1, df2, left_on=['도시','연도'], right_index = True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>도시</th>
      <th>연도</th>
      <th>인구</th>
      <th>데이터1</th>
      <th>데이터2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2000</td>
      <td>9853972</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>서울</td>
      <td>2005</td>
      <td>9762546</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>서울</td>
      <td>2010</td>
      <td>9631482</td>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>부산</td>
      <td>2000</td>
      <td>3655437</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>부산</td>
      <td>2005</td>
      <td>3512547</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

</div>



**예제6. 두 데이터프레임의 key가 모두 인덱스인 경우**


```python
df1 = pd.DataFrame([[1.,2.],[3.,4.],[5.,6.]],
                   index=['a','c','e'],
                   columns=['서울','부산'])
df1

df2=pd.DataFrame([[7.,8.],[9.,10.],
                  [11.,12.],[13.,14.]],
                 index=['b','c','d','e'],
                 columns=['대구','광주'])
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>서울</th>
      <th>부산</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>대구</th>
      <th>광주</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>

</div>



**두 데이터프레임의 인덱스가 키로 사용될 경우**


```python
# 두 데이터프레임의 key가 모두 인덱스인 경우
pd.merge(df1, df2, how='outer', left_index=True, right_index=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>서울</th>
      <th>부산</th>
      <th>대구</th>
      <th>광주</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>

</div>



## 2) join() - 행방향

* **Dataframe1.join(Dataframe2. how='left/right/inner/outer', on=keys)**

- 사용 방법은 merge()와 동일하며, 행 인덱스를 기준으로 병합
- Dataframe1.join(Dataframe2. how='left')가 default값


```python
df1.join(df2, how = 'outer')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>서울</th>
      <th>부산</th>
      <th>대구</th>
      <th>광주</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>

</div>



------------------------------

## 2. 데이터 연결

### concat()

**pd.concat([left, right], axis=0, join='outer', ignore_index=False, keys=None)**

- left, right :  Series, DataFrame, Panel object 리스트
- axis :  0은 위+아래로 합치기, 1은 왼쪽+오른쪽으로 합치기
- join :  'outer': 합집합(union), 'inner': 교집합(intersection)
- ignore_index :  False: 기존 index 유지, True: 기존 index 무시
- keys :  계층적 index 사용하려면 keys 튜플 입력

- 기준열 없이 데이터를 합친다
- 위 아래로 데이터를 결합하는 **행 결합(row bind)**이 기본
- axis 속성을 1로 설정하면 열 결합(column bind)을 수행
- 단순히 두 시리즈나 데이터프레임을 연결하기 때문에 **인덱스 값이 중복**될 수 있다.

#### 행결합 : pd.concat([df1,df2], axis=0)

![](C:\Users\513eh\Downloads\img\join_inout_row.PNG)

#### 열결합 :  pd.concat([df1,df2],axis=1)

![](C:\Users\513eh\Downloads\img\concat_column.png)

### 두 시리즈 데이터 연결

**예제1.**

- 두 시리즈 데이터 생성


```python
s1 = pd.Series([0,1], index = ['A','B'])
s1
s2 = pd.Series([2,3,4], index = ['A','B','C'])
s2
```




    A    0
    B    1
    dtype: int64






    A    2
    B    3
    C    4
    dtype: int64



- 두 시리즈 데이터 연결


```python
# 두 시리즈 연결 : 행방향으로 합침 (axis=0)
pd.concat([s1,s2])
```




    A    0
    B    1
    A    2
    B    3
    C    4
    dtype: int64




```python
# 두 시리즈 연결 : 열방향으로 합침
pd.concat([s1,s2], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>C</th>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

</div>



### 두 데이터프레임 연결

**예제2.**

- 데이터프레임 생성


```python
# concat 연결
df1 = pd.DataFrame({'A': ['A0', 'A1', 'A2', 'A3'], 
                    'B': ['B0', 'B1', 'B2', 'B3'],
                    'C': ['C0', 'C1', 'C2', 'C3'],
                    'D': ['D0', 'D1', 'D2', 'D3']},
                   index=[0, 1, 2, 3])

df2 = pd.DataFrame({'A': ['A4', 'A5', 'A6', 'A7'],
                    'B': ['B4', 'B5', 'B6', 'B7'],
                    'E': ['C4', 'C5', 'C6', 'C7'],
                    'F': ['D4', 'D5', 'D6', 'D7']},
                   index=[0, 1, 2, 3])

df3 = pd.DataFrame({'A': ['A8', 'A9', 'A10', 'A11'],
                    'B': ['B8', 'B9', 'B10', 'B11'],
                    'C': ['C8', 'C9', 'C10', 'C11'],
                    'D': ['D8', 'D9', 'D10', 'D11']},
                   index=[1,2,3,4])
df1
df2
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
    </tr>
  </tbody>
</table>

</div>



**데이터 프레임 행 결합**

- 행을 모두 표현
- join 인수 생략 : 기본값이 'outer'로 지정되어 있음 (모든 열 표현)


```python
result = pd.concat([df1,df2])
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>

</div>




```python
pd.concat([df1,df2], join = 'outer') # 위 코드와 결과가 같음
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>

</div>



**인덱스가 중복된 경우 : 인덱싱을 수행하면?**


```python
# 인덱스가 중복 된 경우 인덱싱을 수행 하면 ?
result
result.iloc[0] # index가 0번째 위치에 있는 행 시리즈 반환
result.loc[0] # index가 0인 행들 전부 반환
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>

</div>






    A     A0
    B     B0
    C     C0
    D     D0
    E    NaN
    F    NaN
    Name: 0, dtype: object






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>

</div>



**인덱스가 중복되므로 기본 인덱스로 재설정**

- 인덱스 열 제거 : drop=True


```python
# 인덱스가 중복 되므로 기본 인덱스로 재 설정
# 인덱스 열은 제거

result.reset_index(drop=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A5</td>
      <td>B5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>A6</td>
      <td>B6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A7</td>
      <td>B7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>

</div>



**concat( , join = 'inner')**

: 공통된 열만 표현


```python
# concat() : 행결합 - 행은 모두 표현
# join='inner' 이므로 열은 공통열만 표현

pd.concat([df1,df2], join = 'inner')
# df1, df2가 가진 공통열 A, B를 가져옴
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
    </tr>
  </tbody>
</table>

</div>



**concat( , ignore_index = True)**

: 기존 인덱스 제거 후 제로베이스 인덱스 설정


```python
# ignore_index = True : 기존 인덱스 제거 후 제로베이스 인덱스 설정

pd.concat([df1,df2], join = 'inner', ignore_index = True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A5</td>
      <td>B5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>A6</td>
      <td>B6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A7</td>
      <td>B7</td>
    </tr>
  </tbody>
</table>

</div>



**concat( , keys=[])**

: 상위 레벨 인덱스 설정


```python
# keys 파라미터를 통해 상위레벨 인덱스 설정 가능
# 3개의 df이므로 각 df에 대응되는 상위 레벨 인덱스를 정의
dF1 = pd.concat([df1,df2,df3], keys=['df1','df2','df3'])
dF1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">df1</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">df2</th>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">df3</th>
      <th>1</th>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>

</div>



- 다중 인덱스인 경우 데이터 접근 : .연산자를 이용한 체인 인덱싱



```python
# 다중 인덱싱 : . 연산자를 이용한 접근
dF1.loc['df3'].loc[1:4]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>

</div>



### concat() 를 이용한 열 결합

**pd.concat([df1,df2], axis=1, join='inner/outer')**

- axis=1
  - 데이터프레임들의 열을 결합


- join='outer' : 기본 설정
  - 모든 행을 표시하고 해당 행의 데이터가 없는 열의 원소는 NaN으로 표시


- join='inner'
  - 병합하는 데이터프레임에 중복되는 인덱스의 행만 표시

**예제3.**


```python
# 예제 df 생성
df1=pd.DataFrame(
    np.arange(6).reshape(3,2),
    index=['a','b','c'],
    columns=['데이터1','데이터2']
)
df1

df2=pd.DataFrame(
    5+np.arange(4).reshape(2,2),
    index=['a','c'],
    columns=['데이터2','데이터4']
)
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>데이터1</th>
      <th>데이터2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>데이터2</th>
      <th>데이터4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>

</div>



- concat( , axis=1, )을 이용한 열 결합 : outer join이 기본으로 적용


```python
pd.concat([df1,df2], axis=1)
# join ='outer'가 기본이므로 생략 가능
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>데이터1</th>
      <th>데이터2</th>
      <th>데이터2</th>
      <th>데이터4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>

</div>



- concat( , axis=0, )을 이용한 행 결합


```python
# 행 결합
pd.concat([df1,df2])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>데이터1</th>
      <th>데이터2</th>
      <th>데이터4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.0</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4.0</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>a</th>
      <td>NaN</td>
      <td>5</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>NaN</td>
      <td>7</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>

</div>



- inner join이 적용된 열 결합


```python
pd.concat([df1,df2], axis=1, join='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>데이터1</th>
      <th>데이터2</th>
      <th>데이터2</th>
      <th>데이터4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>5</td>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>

</div>

