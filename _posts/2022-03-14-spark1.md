---
layout: posts
comments: true
title: "[Spark]í•˜ë‘¡ê³¼ ìŠ¤íŒŒí¬ ê°œë…/ì„¤ì¹˜"
categories: Spark
tag: [Spark, ìŠ¤íŒŒí¬, Hadoop, í•˜ë‘¡, Pyspark]


toc: true
toc_icon: "cog"
toc_sticky: true
date: 2022-03-14
last_modified_at: 2022-03-14

---



# HadoopğŸ˜

* ê³µì‹ í™ˆí˜ì´ì§€ : [https://hadoop.apache.org/](https://hadoop.apache.org/)

## ê°œë…

* ê°œë°œí•œ ë¶„ì˜ ë”¸ì˜ ì• ì°©ì¸í˜• ì´ë¦„ì´ **í•˜ë‘¡**

* ëŒ€ìš©ë‘ ë°ì´í„°ë¥¼ ë¶„ì‚° ì €ì¥ ë° ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” **ìë°” ê¸°ë°˜ì˜ ì˜¤í”ˆì†ŒìŠ¤ í”„ë ˆì„ì›Œí¬**
* êµ¬ê¸€ì´ ë…¼ë¬¸ìœ¼ë¡œ ë°œí‘œí•œ Google FileSystem ë° MapReduce êµ¬í˜„
* ì—¬ëŸ¬ ëŒ€ì˜ ì„œë²„ì— ë°ì´í„°ë¥¼ ë¶„ì‚° ì €ì¥
* ê° ì„œë²„ì— ë¶„ì‚°ë˜ì–´ ìˆëŠ” ë°ì´í„°ë¥¼ ë™ì‹œ ì²˜ë¦¬
* ë°ì´í„°ë¥¼ ë³µì œí•˜ì—¬ ì €ì¥(ë°ì´í„° ìœ ì‹¤ ì‹œ ë³µêµ¬ ìš©ì´)



<br>



## ëª¨ë“ˆ

* Commons :  ë‹¤ë¥¸ ëª¨ë“ˆì„ ì—°ê²° ë° ì§€ì›í•˜ëŠ” **ê¸°ë³¸** ëª¨ë“ˆ
* HDFS : ëŒ€ìš©ëŸ‰ ë°ì´í„° ë¶„ì‚° íŒŒì¼ ì‹œìŠ¤í…œ
* MapReduce : ë°ì´í„°ì…‹ ë³‘ë ¬ ì²˜ë¦¬
* Yarn : ì‘ì—… ì˜ˆì•½ ë° ë¦¬ì†ŒìŠ¤ ê´€ë¦¬



### (1) HDFS

* Hadoop Distributed File System

* êµ¬ê¸€íŒŒì¼ì‹œìŠ¤í…œì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“  ëŒ€ìš©ëŸ‰ ë¶„ì‚° ì €ì¥ / ì²˜ë¦¬ íŒŒì¼ ì‹œìŠ¤í…œ

* NameNodeì™€ DataNodeë¥¼ ê°€ì§€ëŠ” **Master - Slave êµ¬ì¡°**

  * Block êµ¬ì¡° íŒŒì¼ ì‹œìŠ¤í…œ
  * ë…¸ë“œ
    * NameNode 
      * ë©”íƒ€ ë°ì´í„° ê´€ë¦¬
      * ë¸”ë¡ ê´€ë¦¬
    * Secondary NameNode
      * ì²´í¬í¬ì¸íŠ¸ ë…¸ë“œ(fsimage + edit)
      * ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë™ê¸°í™”
    * DataNode
      * ë°ì´í„° ì €ì¥

  ![image](https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/images/hdfsarchitecture.png)

* í•˜ë‘¡ì˜ ê°€ì • ë° ëª©í‘œ

  1. ì¥ì•  ë³µêµ¬
  2. ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ì˜ ë°ì´í„° ë²„ê·¼
  3. ëŒ€ìš©ëŸ‰ ë°ì´í„° ì €ì¥
  4. ë°ì´í„° ë¬´ê²°ì„±
  5. ì´ê¸°ì¢… í•˜ë“œì›¨ì–´ ë° ì†Œí”„íŠ¸ì›¨ì–´ í”Œë«í¼ ê°„ì˜ ì´ì‹ì„±





### (2) Map Reduce

* ì°¸ê³  : [https://hadoop.apache.org/docs/stable/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html](https://hadoop.apache.org/docs/stable/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html)

* ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ë³‘ë ¬ë¡œ ë¶„ì„í•´ì„œ ë¶„ì‚° ì²˜ë¦¬ ì§€ì›í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ í”„ë ˆì„ì›Œí¬
* í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° + ë¶„ì‚° ì»´í“¨íŒ…
* ë°ì´í„° ì „ì†¡, ë¶„ì‚° ë³‘ë ¬ ì²˜ë¦¬ ë“±ì€ MapReduce í”„ë ˆì„ì›Œí¬ê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì„œ ê°œë°œìëŠ” MapReduce ì•Œê³ ë¦¬ì¦˜ì— ë§ê²Œ ë¶„ì„í”„ë¡œê·¸ë¨ì„ ê°œë°œí•˜ë©´ëœë‹¤.
* Map -> Reducer(Shuffle, Sort, Reduce)
  * Map(Data Transformation) : ì…ë ¥í•œ ë°ì´í„°ë¥¼ splití•˜ê³  key / valueë¡œ í•´ì„í•œë‹¤. ê·¸ë¦¬ê³  ë ˆì½”ë“œë¥¼ mapì´ ë°›ì•„ì„œ ì²˜ë¦¬í•œë‹¤.
  * Shuffle : Map Taskì—ì„œ ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ ì„ëŠ”ë‹¤.
  * Sort : ì •ë ¬í•˜ê³  Reducerë¡œ ì „ë‹¬
  * Reduce(Data Aggregation) : ì²˜ë¦¬ë˜ì–´ ì „ë‹¬ëœ ê²°ê³¼ë¥¼ ì§‘ê³„í•œë‹¤.
* MapReduce Framework
  * JobClient : Hadoop MapReduce API
  * JobTracker : JobScheduling ë° TaskTracker ì— Job í• ë‹¹(ì¼ë°˜ì ìœ¼ë¡œ NameNode ì‹¤í–‰)
  * TaskTracker
    * ìš”ì²­ëœ jobì„ ë°›ì•„ ë§µë¦¬ë“€ìŠ¤(task) ì‹¤í–‰
    * JobTracker ì—ê²Œ HeartBeat ì „ì†¡
    * DataNodeì—ì„œ ì‹¤í–‰
* Hadoop 1.x MapReduceì˜ ë¬¸ì œì 
  * JobTrackerê°€ ìŠ¤ì¼€ì¤„ë§, íƒœìŠ¤í¬ ê´€ë¦¬ ê¸°ëŠ¥ì„ ìˆ˜í–‰ -> ì‘ì—… ê´€ë¦¬ì™€ ìì› ë¶„ë°°ì˜ ë¹„íš¨ìœ¨ì„±
  * JobTracker ë¯¸ ì‹¤í–‰ì‹œ TaskTracker ì‹¤í–‰í•´ë„ MapReduce ë¶ˆê°€
  * MapReduce API ë¡œ ê°œë°œëœ ì• í”Œë¦¬ì¼€ì´ì…˜ë§Œ ì‹¤í–‰ ê°€ëŠ¥





### (3) Yarn

![image](https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/yarn_architecture.gif)

* ì°¸ê³  : [https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/YARN.html](https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/YARN.html)
* **Y**et **A**noter **R**esource **N**egotator ì˜ ì•½ì
* ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ë° ì‘ì—… ì˜ˆì•½í•˜ê³  ëª¨ë‹ˆí„°ë§í•œë‹¤.
* JobTrackerë¥¼ ë¶„ë¦¬
  * ResourceManager : Yarn Application ì‹œì‘ / DataNode ë¦¬ì†ŒìŠ¤ í• ë‹¹
  * ApplicationMater : Task Scheduling ë° ì‹¤í–‰ ê´€ë¦¬
  * JobHistoryServer : ëª¨ë“  Job ì— ëŒ€í•œ metadata ê´€ë¦¬
* TaskTrackerì˜ ë‹¨ì¼ ê³„ì‚° ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ë¶€ë¶„ì€ NodeManagerê°€ ë‹´ë‹¹í•œë‹¤.
  * NodeManager : Container ë‹¨ìœ„ë¡œ ë‹¨ì¼ ì„œë²„ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬





<br>



## í™˜ê²½ì„¤ì •/ì¤€ë¹„(ì„¤ì¹˜, ê¸°íƒ€)

â—**ìš°ë¶„íˆ¬ ë¦¬ëˆ…ìŠ¤ê°€ ê¹”ë ¤ìˆì–´ì•¼í•©ë‹ˆë‹¤.**â—

* ìš°ì„  ìš°ë¶„íˆ¬ ê°€ìƒì»´í“¨í„°ì—ì„œ

  * `sudo apt install openssh-server ssh-askpass -y`
  * `ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa`
    * ë„¤ì„ë…¸ë“œì™€ ë°ì´í„°ë…¸ë“œê°€ ì„œë¡œ ì ‘ì†í•  ë•Œ ì‹œíì–´ ì…€ì´ í•„ìš”í•˜ì§€ ì•Šê²Œ ìë™ìœ¼ë¡œ í‚¤ë¥¼ ë§Œë“œëŠ” ê³¼ì •
  * `cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys`
    * ë§Œë“¤ì–´ì§„ í‚¤ë¥¼ authorized_keysì— ë„£ì–´ì¤Œ

* java ê°œë°œììš© ë‹¤ìš´í•´ì•¼í•¨

  * OpenJDK(java development kit) vs Amazon Corretto

  * Amazon Correttoë¥¼ ë‹¤ìš´ë°›ì„ ê²ƒì´ë‹¤.

    [https://aws.amazon.com/ko/corretto/?filtered-posts.sort-by=item.additionalFields.createdDate&filtered-posts.sort-order=desc](https://aws.amazon.com/ko/corretto/?filtered-posts.sort-by=item.additionalFields.createdDate&filtered-posts.sort-order=desc)

  * 11version ë‹¤ìš´ í´ë¦­

    ![image](https://user-images.githubusercontent.com/75322297/157816644-9fc43494-b824-4688-a6b8-a733e6a41756.png)

  * í•´ë‹¹ ë‚´ìš©ì„ ìš°ë¶„íˆ¬ì— ë³µì‚¬ í›„ ì…ë ¥

    ![image](https://user-images.githubusercontent.com/75322297/157816781-364c4151-621e-4443-8cd8-902b47249e8f.png)

  * amazon-correttoê°€ ìš°ë¶„íˆ¬ ì•ˆì— ì••ì¶•íŒŒì¼ë¡œ ìˆì„ ê²ƒì´ë‹¤.

    ![image](https://user-images.githubusercontent.com/75322297/157818653-b8b3aa41-1cf5-4f13-96f9-3b0c908fb7d9.png)

  * ì••ì¶• í’€ê¸°

    * `tar xvzf amazon-corretto-11-x64-linux-jdk.tar.gz` ì…ë ¥

  * javaë¼ëŠ” ë°”ë¡œê°€ê¸° ë§Œë“¤ì–´ì£¼ê¸°

    * `ln -s amazon-corretto-11.0.14.10.1-linux-64/ java` ì…ë ¥

  * `ls -al` ë¡œ ìˆ¨ê²¨ì§„ íŒŒì¼ì„ í™•ì¸í•˜ê³ , ìˆ¨ê²¨ì ¸ìˆë˜  `.bashrc` íŒŒì¼ì˜ ë‚´ìš©ì„ vim ì—ë””í„°ë¡œ ìˆ˜ì •í•˜ì.

    * `.bahsrc`ëŠ” í„°ë¯¸ë„ì´ ì‹¤í–‰ë  ë•Œ ê°€ì¥ ë¨¼ì € ì½í˜€ì§€ëŠ” íŒŒì¼
    * `sudo vim ~/.bashrc` 
    * ë§¨ ë°‘ìœ¼ë¡œ ë‚´ë ¤ê°„ë‹¤.
    * ë‹¨ì¶•í‚¤ o ì…ë ¥ í•´ì„œ  ë‹¤ìŒì¤„ë¡œ ë„˜ì–´ê°€ë©° insert modeë¡œ ì „í™˜
    * ![image](https://user-images.githubusercontent.com/75322297/157819721-ab2a4668-2af3-4478-940b-228e7345d375.png)
    * `export JAVA_HOME=/home/ê³„ì •ëª…/java` ì…ë ¥
    * `export PATH=$PATH:$JAVA_HOME/bin` ì…ë ¥
    * esc ë‹¨ì¶•í‚¤ ëˆ„ë¥¸ í›„ `:wq!` ì…ë ¥

  * vim ì—ë””í„°ì—ì„œ ë‚˜ì™€ì„œ `source ~/.bashrc` ì…ë ¥

    * `source`ëŠ” ë³€ê²½ì‚¬í•­ì„ ì§€ê¸ˆ ë‹¹ì¥ ì ìš©ì‹œì¼œë‹¬ë¼ëŠ” ëª…ë ¹

  * javaë²„ì „ê³¼ javacë²„ì „ í™•ì¸

    * `java -version`
    * `javac -version`
    * ![image](https://user-images.githubusercontent.com/75322297/157822775-131484ca-28b3-4ad4-9c1e-998877d26b39.png)

* íŒŒì´ì¬ë„ ì„¤ì¹˜í•´ì•¼í•œë‹¤.(**3.7**ì´í•˜ ë²„ì „)

  * íŒŒì´ì¬ 3.8ë²„ì „ì´ ê¸°ì¡´ì— ì¡´ì¬í•˜ì§€ë§Œ **ì œí”Œë¦°ê³¼ í˜¸í™˜ì´ ì•ˆë˜ê¸° ë•Œë¬¸ì—** ë”°ë¡œ ì„¤ì¹˜í•´ì¤˜ì•¼í•œë‹¤.

    ![image](https://user-images.githubusercontent.com/75322297/157825047-436d538b-7bd8-4424-9d50-ea05a98b7ffc.png)

  * `sudo add-apt-repository ppa:deadsnakes/ppa` ì…ë ¥

    * 3.7ë²„ì „ ì„¤ì¹˜ë¥¼ íŒŒì¼ì„ ì œê³µí•´ì£¼ëŠ” repoë¥¼ ì¶”ê°€

  * `sudo apt update` ì…ë ¥

    * íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸

  * `sudo apt install python3.7 -y`

    * íŒŒì´ì¬ 3.7ë²„ì „ ì„¤ì¹˜

  * `sudo vim ~/.bashrc` 

    ![image](https://user-images.githubusercontent.com/75322297/157824782-dac37fef-28c2-46d7-857b-e3f1815324e6.png)

    * `alias python=python3.7` ì…ë ¥
    * `alias python3=python3.7` ì…ë ¥
    * `:wq!`ë¡œ ì €ì¥í•˜ê³  vim ì—ë””í„° ì¢…ë£Œ

  * `source ~/.bashrc` ë¡œ ë³€ê²½ì‚¬í•­ ì ìš©

  * `python --version`, `python3 --version`ìœ¼ë¡œ ë²„ì „ í™•ì¸

    ![image](https://user-images.githubusercontent.com/75322297/157824969-21d5af7d-89ee-4ce0-b184-61391bc20789.png)

  * `sudo apt install python3-pip -y`

    * íŒŒì´ì¬ ë‚´ì¥íŒ¨í‚¤ì§€ ì„¤ì¹˜

  * `.bashrc` íŒŒì¼ ì¼œì„œ ë‚´ìš© ì¶”ê°€

    * `sudo vim ~/.bashrc`
    * `alias pip="python3.7 -m pip"`  ë‚´ìš© ì¶”ê°€
    * ![image](https://user-images.githubusercontent.com/75322297/157827994-eb00f52c-74b1-4cf0-9fc4-931636e57e9a.png)
    * `:wq!`ë¡œ vim ì¢…ë£Œ

  * `source ~/.bashrc` ë¡œ ë³€ê²½ì‚¬í•­ ì ìš©

  * `pip --version`ìœ¼ë¡œ ë²„ì „ í™•ì¸

    * ![image](https://user-images.githubusercontent.com/75322297/157828200-21b8b1ac-eb90-458c-af1c-c8947660edab.png)
    * 3.7 ë²„ì „ìœ¼ë¡œ ì˜ ì ìš©ëœ ê²ƒì„ í™•ì¸

* ì´ì œ í•˜ë‘¡ì„ ë‹¤ìš´ ë°›ì„ ì°¨ë¡€ë‹¤.

  * 3.31ë²„ì „ ë‹¤ìš´ë°›ì„ ê²ƒì´ë‹¤. ë”°ë¼ì„œ ë°±ì—…ì‚¬ì´íŠ¸ë¡œ ê°€ì•¼í•œë‹¤.

  * [í•˜ë‘¡ë°±ì—…í˜ì´ì§€](https://downloads.apache.org/hadoop/common/hadoop-3.3.1/)

  * tar.gzíŒŒì¼ì„ ì°¾ì•„ì„œ ë§í¬ì£¼ì†Œë¥¼ ë³µì‚¬í•´ì˜¨ë‹¤.

    ![image](https://user-images.githubusercontent.com/75322297/157829062-098a6d1f-6530-484a-89df-388143323e0f.png)

  * ìš°ë¶„íˆ¬ì—ì„œ `wget https://downloads.apache.org/hadoop/common/hadoop-3.3.1/hadoop-3.3.1.tar.gz` ì…ë ¥ í•´ì„œ ì••ì¶•íŒŒì¼ ë‹¤ìš´

  * ì••ì¶• í’€ê¸°

    * `tar xvzf hadoop-3.3.1.tar.gz`

  * hadoop ì´ë¼ëŠ”  ë°”ë¡œê°€ê¸° ë§Œë“¤ì–´ì£¼ê¸°

    * `ln -s hadoop-3.3.1 hadoop`

  * ë°°ì‰¬ê°€ ì‹¤í–‰ë  ë•Œ í•˜ë‘¡ì´ ì¼œì§€ê²Œ í™˜ê²½ë³€ìˆ˜ ì„¤ì •(PATH ë“± ì„¤ì •)

    * `sudo vim ~/.bashrc` ì‹¤í–‰ í›„ ì‘ì„±
    * ![image](https://user-images.githubusercontent.com/75322297/158085660-e45985ed-d9dd-4e4f-8ffe-ff8013959e55.png)

  * ì´ë²ˆì—” ë™ì¼íŒŒì¼ì—ì„œ í•˜ë‘¡ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ ì € ì„¤ì •

    * ![image](https://user-images.githubusercontent.com/75322297/158085984-0d861d66-98b9-46f4-b0d2-9ceacd075c30.png)
    * `big`ìë¦¬ì— ìì‹ ì´ ì›í•˜ëŠ” ê³„ì •ëª…ì„ ì ì–´ì£¼ë©´ ëœë‹¤.
    * ë‹¤í•˜ê³  esc í›„ `:wq!`: ë¡œ ì €ì¥ í›„ ì—ë””í„°ë¥¼ ì¢…ë£Œ

  * ë³€ê²½ì‚¬í•­ ë°”ë¡œ ì ìš©

    * `source ~/.bashrc`

  * ê²½ë¡œ ë°”ê¾¸ê¸°

    * `cd $HADOOP_CONF_DIR`
    * `ls`
    * ![image](https://user-images.githubusercontent.com/75322297/158086609-12dd680d-6e26-47c0-aa31-be20a8e729cb.png)

  * ê±´ë“œë ¤ì•¼í•˜ëŠ” íŒŒì¼ ëª‡ ê°€ì§€ê°€ ìˆë‹¤.

    * hadoop-env.sh
    * core-site.xml
    * hdfs-site.xml
    * mapred-site.xml

  * hadoop-env.sh

    * `vim hadoop-env.sh`
    * 54ë²ˆì§¸ ì¤„ ë¶€í„° 3ê°œ
      * ![image](https://user-images.githubusercontent.com/75322297/158086782-bca4331a-3bd5-4a97-9136-63a57b74f578.png)
    * 198ë²ˆì§¸ ì¤„ ë¶€í„° 1ê°œ
      * ![image](https://user-images.githubusercontent.com/75322297/158086895-b64f27ee-b5e4-424c-834d-b5ddd368d0e3.png)
    * ì €ì¥ í›„ ì—ë””í„° ì¢…ë£Œ

  * core-site.xml

    * ê¸°ë³¸ì ì¸ íŒŒì¼ì‹œìŠ¤í…œì˜ ìš”ì²­ ê²½ë¡œë¥¼ ì¡ì•„ì£¼ëŠ” ê³³
    * `vim core-site.xml`
    * ![image](https://user-images.githubusercontent.com/75322297/158087035-ca61b1dd-17a8-4dc7-a51c-44c17a85517e.png)
    * ì €ì¥ í›„ ì—ë””í„° ì¢…ë£Œ

  * hdfs-site.xml

    * ì‹±ê¸€ëª¨ë“œ
    * replicationì€ ë„¤ì„ë…¸ë“œì—ì„œ ë°ì´í„°ë…¸ë“œë¡œ ë³µì‚¬ë˜ëŠ” ë°ì´í„°ì˜ ë¶„í• ìˆ˜
    * `vim hdfs-site.xml`
    * ![image](https://user-images.githubusercontent.com/75322297/158087313-3aef9812-6d22-4e50-90e0-eddb59a085bb.png)

  * mapred-site.xml

    * map reduceí•  ë•Œ yarn í”„ë ˆì„ ì›Œí¬ë¥¼ ì‚¬ìš©í•œë‹¤ê³  ì„¤ì •
    * `vim mapred-site.xml`
    * ![image](https://user-images.githubusercontent.com/75322297/158088156-3cd19b64-32e2-4141-9357-585a0a253d1a.png)

  * ì„¤ì •ì´ ëë‚¬ìœ¼ë©´ ë„¤ì„/ë°ì´í„° ë…¸ë“œ í¬ë§¤íŒ… í•´ì£¼ê¸°

    * `hdfs namenode -format`
    * `hdfs datanode -format`

  * í”„ë ˆì„ì›Œí¬ ì‹¤í–‰

    * `start-dfs.sh`
    * `start-yarn.sh`
    * `jps`
    * ![image](https://user-images.githubusercontent.com/75322297/158090642-5c07d70b-15da-426a-935b-a3fbeab6eaf3.png)
    * ë§Œì•½ ë‹¤ ë©ˆì¶”ê³  ì‹¶ë‹¤ë©´ `stop-all.sh`
      * `stop-dfs.sh`
      * `stop-yarn.sh`
    * ë§Œì•½ startë¶€ë¶„ì—ì„œ ì—ëŸ¬ê°€ ë‚œë‹¤ë©´
      * `sudo apt purge openssh-server`
      * `sudo apt install openssh-server`

  * `hdfs dfsadmin -report` : í•˜ë‘¡ì— ê´€ë ¨ ì •ë³´

  * íŒŒì´ì–´í­ìŠ¤ë¥¼ ì¼œì„œ localhost:9870ìœ¼ë¡œ ê°€ë³´ì.

    * hdfs ê´€ë ¨ëœ í˜ì´ì§€
    * Live Nodesê°€ 1ë¡œ ë˜ì–´ìˆì–´ì•¼ ì •ìƒ
    * ![image](https://user-images.githubusercontent.com/75322297/158095330-7b32f35e-9125-4932-90af-27e82cef0d5e.png)

  * ì´ë²ˆì—” localhost:8088ë¡œ ê°€ë³´ì

    * yarn ê´€ë ¨ í˜ì´ì§€
    * ![image](https://user-images.githubusercontent.com/75322297/158095415-6256ff18-75fd-4dc8-8df6-6f8d8641ea8a.png)









# Spark

## ê°œë…

* APACHE SPARK : ë¹…ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ ë¶„ì„ ì—”ì§„
* sparkëŠ” ê¸°ë³¸ì ìœ¼ë¡œ SCALA(Java Virtual Machine ê¸°ë°˜)

![image](https://user-images.githubusercontent.com/75322297/158107941-7521c053-51d2-4c11-a0e1-f2a3fe47c043.png)

* íŠ¹ì§•
  * ì„±ëŠ¥ê³¼ í¸ì˜ì„± ëª¨ë‘ ê³ ë ¤
  * ë‚´ì¥ë©”ëª¨ë¦¬ ë°©ì‹ìœ¼ë¡œ ì¸í•œ ë¹ ë¥¸ ì†ë„
  * lazy-evaluation(lazy-execution)
* êµ¬ì„± ìš”ì†Œ
  * Driver 
    * sparkSession ìƒì„±
    * main í˜¸ì¶œ
    * í”„ë¡œê·¸ë¨ ìŠ¤ì¼€ì¥´ë§
    * ë¶„ì„ ë° ë°°í¬
  * Cluster Manager
    * Executor(master, slave) ê´€ë¦¬
  * Executor
    * í”„ë¡œì„¸ìŠ¤ê°€ í• ë‹¹í•œ jobì„ ìˆ˜í–‰
  * SparkSession
    * í´ë¼ì´ì–¸íŠ¸ì˜ ëª…ë ¹ì„ cluster(Executor)ì—ì„œ ì‹¤í–‰
* ë°ì´í„° êµ¬ì¡°
  * RDD : Resilient Distributed DataSet (ë‚´ê²°í•¨ì„± ë¶„ì‚° ë°ì´í„° ì…‹)
    * ë‚´ê²°í•¨ì„±ì´ë€? 
      * í•˜ë“œì›¨ì–´ ì¥ì• ì™€ ê°™ì€ ëŒë°œ ì‚¬íƒœì— ëŒ€ë¹„í•  ìˆ˜ ìˆëŠ” ì»´í“¨í„° ë˜ëŠ” ìš´ì˜ì²´ì œì˜ ê¸°ëŠ¥
  * DataFrame : rowì™€ columnì˜ ê°œë…ì„ ê°€ì§€ëŠ” ìë£Œêµ¬ì¡°
    * DataSet[Row] (Row íƒ€ì…ìœ¼ë¡œ êµ¬ì„±ëœ Dataset)
    * ë¹„íƒ€ì…í˜• api - ëŸ°íƒ€ì„ ì‹œ ë°ì´í„°ì˜ íƒ€ì…ì„ í™•ì¸
  * DataSet : javaì™€ scalaë§Œ ì‚¬ìš© ê°€ëŠ¥í•œ ìë£Œêµ¬ì¡°
    * íƒ€ì…í˜• api - ì»´íŒŒì¼ ì‹œ ë°ì´í„°ì˜ íƒ€ì…ì„ í™•ì¸
* Spark Core
  * Main Component(ê¸°ë³¸ ê¸°ëŠ¥) : ë°°ì¹˜ ë‹¨ìœ„ì˜ RDD (Resilient Distributed Dataset) ì—°ì‚° ë° ì²˜ë¦¬
    * **RDDë€ ë‚´ ê²°í•¨ì„± ë¶„ì‚° ë°ì´í„°ì…‹ìœ¼ë¡œ ì¥ì•  ë³µêµ¬ì— ìš©ì´í•˜ë‹¤.**





<br>



## í™˜ê²½ì„¤ì •(ì„¤ì¹˜)

* Spark í™ˆí˜ì´ì§€ : [https://spark.apache.org/downloads.html](https://spark.apache.org/downloads.html)

1. ì•„íŒŒì¹˜ ìŠ¤íŒŒí¬ í™ˆí˜ì´ì§€ì˜ ë‹¤ìš´ë¡œë“œë¡œ ê°€ì„œ ë²„ì „ì„ 3.1.3 ë²„ì „ì„ ì„ íƒí•˜ê³ , pre-built with user-provided Apache hadoop ì„ ì„ íƒ í›„ 3ë²ˆì˜ ë‹¤ìš´ë¡œë“œ ë§í¬ í´ë¦­

   ![image](https://user-images.githubusercontent.com/75322297/158095586-76adf740-d416-4908-86b7-3338bc54f923.png)

2. ë§í¬ ì£¼ì†Œ ë³µì‚¬.

   ![image](https://user-images.githubusercontent.com/75322297/158095654-90d3e742-fb9d-4026-949a-97b1646a0794.png)

3. ìš°ë¶„íˆ¬ì—ì„œ wgetì„ ì‚¬ìš©í•´ì„œ ë‹¤ìš´

   * `wget https://dlcdn.apache.org/spark/spark-3.1.3/spark-3.1.3-bin-without-hadoop.tgz`

4. ì••ì¶•í•´ì œ í›„ sparkë¼ëŠ” ì‹¬ë³¼ë¦­ ë§í¬ ë§Œë“¤ê¸°

   * ì••ì¶• í•´ì œ
     * `tar xvzf spark-3.1.3-bin-without-hadoop-tgz`
   * spark ì‹¬ë³¼ë¦­ ë§í¬ ë§Œë“¤ê¸°
     * `ln -s spark-3.1.3-bin-without-hadoop spark`

   ![image](https://user-images.githubusercontent.com/75322297/158102848-52c8fe4e-a58d-4071-82c8-6b07c04f484b.png)

5. ê²½ë¡œ ì¡ê¸°

   * `sudo vim ~/.bashrc`

     ![image](https://user-images.githubusercontent.com/75322297/158103206-260ff588-a46d-43f1-a832-0d5362b0bf08.png)

6. ë°”ë¡œ ì ìš©ì‹œí‚¤ê¸°

   * `source ~/.bashrc`

7. `cd $SPARK_HOME/conf` ë¡œ ê²½ë¡œ ì´ë™

8. íŒŒì¼ ë³µì‚¬

   * `cp workers.template workers`

   * `cp spark-env.sh.template spark-env.sh`

9. `vim spark-env.sh`

   ![image](https://user-images.githubusercontent.com/75322297/158114037-285fb2bb-0821-4dfe-8193-d62b29e331e1.png)

   1. ê²½ë¡œë“¤ ì‘ì„±!
   2. export JAVA_HOME=/home/big/java
   3. export HADOOP_CONF_DIR=/home/big/hadoop/etc/hadoop
   4. export YARN_CONF_DIR=/home/big/hadoop/etc/hadoop
   5. export SPARK_DIST_CLASSPATH=$(/home/big/hadoop/bin/hadoop classpath)
   6. export PYSPARK_PYTHON=/usr/bin/python3.7
   7. export PYSPARK_DRIVER_PYTHON=/usr/bin/python3.7

10. `cp spark-defaults.conf.template spark-defaults.conf`

11. `vim spark-defaults.conf`

    * `spark.master							yarn`

12. `cd`  ì—”í„°í•˜ê³ 

    * `start-dfs.sh` 
    * `start-yarn.sh`
    * `pyspark`

13. ì´ëŸ° í™”ë©´ì´ ë‚˜ì˜¨ë‹¤ë©´ ì„±ê³µâ­•

    ![image](https://user-images.githubusercontent.com/75322297/158114376-7877fa0d-66dc-4f60-b405-a8fb08cbd559.png)